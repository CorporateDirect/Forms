"use strict";var FormLib=(()=>{var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,a={};((t,i)=>{for(var n in i)e(t,n,{get:i[n],enumerable:!0})})(a,{FormState:()=>r,clearAllErrors:()=>he,clearError:()=>ye,clearSummary:()=>qe,default:()=>Ze,getCleanState:()=>Q,getDiagnosticState:()=>ue,getFieldsWithErrors:()=>Ee,goToStep:()=>P,goToStepById:()=>V,goToStepByIdClean:()=>X,goToStepByIdDiagnostic:()=>ce,hasError:()=>ve,initErrors:()=>ge,initMultiStep:()=>z,initMultiStepClean:()=>Y,initMultiStepDiagnostic:()=>se,initSummary:()=>Ve,initValidation:()=>we,showError:()=>fe,showErrors:()=>Se,updateSummary:()=>Be,validateAllVisibleFields:()=>De,validateField:()=>Ce,validateStep:()=>Fe});var o={MULTISTEP:'[data-form="multistep"]',LOGIC:"[data-logic]",STEP:'[data-form="step"]',ANSWER:"[data-answer]",GO_TO:"[data-go-to]",SKIP:"[data-skip]",NEXT_BTN:'[data-form="next-btn"]',BACK_BTN:'[data-form="back-btn"]',SUBMIT:'[data-form="submit"]',SUBMIT_BTN:'[data-form="submit-btn"]',ERROR_DISPLAY:'[data-form="error"]',SHOW_IF:"[data-show-if]",STEP_TYPE:"[data-step-type]",STEP_SUBTYPE:"[data-step-subtype]",STEP_NUMBER:"[data-step-number]",STEP_FIELD_NAME:"[data-step-field-name]",SUMMARY_FIELD:"[data-summary-field]",SUMMARY_TYPE:"[data-summary-type]",SUMMARY_SUBTYPE:"[data-summary-subtype]",SUMMARY_NUMBER:"[data-summary-number]",JOIN:"[data-join]",REQUIRED:"[required]",ERROR_MESSAGE:"[data-error-message]",VALIDATE:"[data-validate]",ALL_INPUTS:"input, select, textarea"},s={START_STEP:1,DEBUG:!0,LOG_PREFIX:"[FormLib]",VALIDATION_DELAY:300,ANIMATION_DURATION:300,JOIN_SEPARATOR:{space:" ",comma:", ",dash:" - ",pipe:" | ",newline:"\n"}},l={ACTIVE_STEP:"active-step",HIDDEN_STEP:"hidden-step",HIDDEN_STEP_ITEM:"hidden-step-item",ERROR_FIELD:"error-field",ACTIVE_ERROR:"active-error",DISABLED:"disabled"},r=class e{constructor(){this.data={},u("FormState initialized (simplified)")}static getInstance(){return e.instance||(e.instance=new e),e.instance}setField(e,t){const i=this.data[e];this.data[e]=t,u(`Field updated: ${e}`,{oldValue:i,newValue:t})}getField(e){return this.data[e]}getAll(){return{...this.data}}clear(){const e={...this.data};this.data={},u("FormState cleared",{oldData:e})}clearFields(e){const t={};e.forEach(e=>{void 0!==this.data[e]&&(t[e]=this.data[e],delete this.data[e])}),Object.keys(t).length>0&&u("Fields cleared due to branch change",t)}getDebugInfo(){return{data:this.data,fieldCount:Object.keys(this.data).length}}}.getInstance(),d=new class{constructor(){this.events={},this.moduleStates=new Map}registerModule(e){this.moduleStates.set(e,{initialized:!0,name:e})}unregisterModule(e){this.moduleStates.delete(e)}isModuleInitialized(e){return this.moduleStates.get(e)?.initialized??!1}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.off(e,t)}}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==t))}emit(e,t){const i=String(e);if(console.log(`üîÑ [FormEvents] Emitting event: ${i}`,{eventData:t,timestamp:(new Date).toISOString(),hasListeners:!!this.events[e],listenerCount:this.events[e]?.length||0}),!this.events[e])return void console.warn(`‚ö†Ô∏è [FormEvents] No listeners registered for event: ${i}`);if("skip:request"===e&&!this.isModuleInitialized("multiStep"))return void console.error(`‚ùå [FormEvents] CRITICAL: Skipping '${i}' event - multiStep module not initialized`,{eventData:t,registeredModules:Array.from(this.moduleStates.keys()),multiStepState:this.moduleStates.get("multiStep")});if("branch:change"===e&&!this.isModuleInitialized("multiStep"))return void console.error(`‚ùå [FormEvents] CRITICAL: Skipping '${i}' event - multiStep module not initialized`,{eventData:t,registeredModules:Array.from(this.moduleStates.keys()),multiStepState:this.moduleStates.get("multiStep")});let n=0,a=0;this.events[e].forEach((o,s)=>{try{console.log(`üì° [FormEvents] Calling listener ${s+1}/${this.events[e].length} for ${i}`),o(t),n++,console.log(`‚úÖ [FormEvents] Listener ${s+1} completed successfully for ${i}`)}catch(n){a++,console.error(`üí• [FormEvents] LISTENER ERROR ${s+1}/${this.events[e].length} for '${i}':`,{error:n,errorMessage:n instanceof Error?n.message:String(n),errorStack:n instanceof Error?n.stack:void 0,eventData:t,listenerIndex:s})}}),console.log(`üìä [FormEvents] Event ${i} completed:`,{totalListeners:this.events[e].length,successful:n,failed:a,eventData:t})}},c=new Map;function u(e,t){if(!s.DEBUG)return;const i=(new Date).toISOString().split("T")[1].split(".")[0],n=`${s.LOG_PREFIX} [${i}]`;void 0!==t?console.log(`${n} ${e}`,t):console.log(`${n} ${e}`)}function m(e,t=document){if(t===document){const i=`all:${e}`;if(c.has(i))return c.get(i);const n=t.querySelectorAll(e);return c.set(i,n),n}return t.querySelectorAll(e)}function p(e,t){return e.getAttribute(t)}function g(e,t){e.classList.add(t)}function f(e,t){e.classList.remove(t)}function y(e){const t=getComputedStyle(e).display;t&&"none"!==t&&e.setAttribute("data-original-display",t),g(e,"hidden-step"),e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important"),e.style.setProperty("opacity","0","important"),console.log("üîÑ [Utils] Hiding element:",{element:e,tagName:e.tagName,id:e.id,className:e.className,originalDisplay:t,currentDisplay:e.style.display,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:h(e)})}function h(e){const t=getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity&&!function(e,t){return e.classList.contains(t)}(e,"hidden-step")}function S(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}function v(e){return e instanceof HTMLInputElement?"checkbox"===e.type||"radio"===e.type?e.checked?e.value:"":e.value:e instanceof HTMLSelectElement&&e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value}function E(e,t,i,n){const a=e=>{const t=e.target?.closest(i);t&&n(e,t)};return e.addEventListener(t,a),()=>{e.removeEventListener(t,a)}}var b=!1,I=[];function A(e,t){if(!S(t))return;const i=w(t),n=v(t);i&&(r.setField(i,n),u("Field input detected",{fieldName:i,value:n,eventType:"input"}),d.emit("field:input",{fieldName:i,value:n,element:t,eventType:"input"}))}function N(e,t){if(!S(t))return;const i=w(t),n=v(t);i&&(r.setField(i,n),u("Field change detected",{fieldName:i,value:n,eventType:"change"}),d.emit("field:change",{fieldName:i,value:n,element:t,eventType:"change"}))}function T(e,t){if(!S(t))return;const i=w(t),n=v(t);i&&(u("Field blur detected",{fieldName:i,value:n,eventType:"blur"}),d.emit("field:blur",{fieldName:i,value:n,element:t,eventType:"blur"}))}function w(e){return e.name||p(e,"data-step-field-name")||null}function L(){b?(u("Resetting field coordinator"),I.forEach(e=>e()),I=[],b=!1,u("Field coordinator reset complete")):u("Field coordinator not initialized, nothing to reset")}var C=!1,$=[],M=[],R=[],F=-1,D="",O=[],_=new Set;function z(e=document){C&&(u("MultiStep already initialized, cleaning up first"),function(){if(!C)return void u("Multi-step module not initialized, nothing to reset");u("Resetting multi-step module"),d.unregisterModule("multiStep"),$.forEach(e=>e()),$=[],R=[],F=-1,D="",O=[],_.clear(),C=!1,M.forEach(e=>e()),M=[],u("Multi-step module reset")}()),console.log("üöÄ [MultiStep] === UPDATED STRUCTURE INITIALIZATION ===");const t=e.querySelectorAll(".step_wrapper[data-answer]");console.log("üìã [MultiStep] Found step wrappers with data-answer:",{count:t.length,selector:".step_wrapper[data-answer]"}),0!==t.length?(R=Array.from(t).map((e,t)=>{const i=p(e,"data-answer"),n="true"===p(e,"data-branch"),a=e.closest('[data-form="step"]');return console.log(`‚úÖ [MultiStep] Registered step wrapper ${t}:`,{id:i,isBranch:n,hasParentStep:!!a,element:{tagName:e.tagName,className:e.className}}),{element:e,id:i||`step-${t}`,index:t,isBranch:n,parentStepElement:a}}),console.log("üìä [MultiStep] Step registration complete:",{totalSteps:R.length,stepIds:R.map(e=>e.id),branchSteps:R.filter(e=>e.isBranch).map(e=>e.id),regularSteps:R.filter(e=>!e.isBranch).map(e=>e.id)}),R.forEach((e,t)=>{console.log(`ü´• [MultiStep] Hiding step ${t} (${e.id})`),y(e.element)}),function(e){const t=E(e,"click",o.NEXT_BTN,k),i=E(e,"click",o.BACK_BTN,U),n=E(e,"click",o.SUBMIT_BTN,q),a=E(e,"change",'input[type="radio"][data-go-to]',H),s=E(e,"click",'input[type="radio"][data-go-to]',H),l=E(e,"click","label",x),r=E(e,"click","[data-go-to]",B);$.push(t,i,n,a,s,l,r),u("Enhanced navigation listeners with Webflow compatibility setup complete")}(e),function(){const e=d.on("step:navigate",e=>{const t=e;console.log("üéØ [MultiStep] Navigation event received:",{targetStepId:t.targetStepId,reason:t.reason}),t.targetStepId&&V(t.targetStepId)});M.push(e)}(),function(e){const t=E(e,"click",o.SKIP,G);$.push(t),u("Skip listeners setup complete")}(e),R.length>0&&(console.log("üé¨ [MultiStep] Showing initial step: 0"),P(0)),C=!0,d.registerModule("multiStep"),console.log("‚úÖ [MultiStep] Updated structure initialization complete")):console.error("‚ùå [MultiStep] No step wrappers with data-answer found!")}function V(e){if(console.log("üéØ [MultiStep] NAVIGATION to step ID:",e),!C)return void console.error("‚ùå [MultiStep] Not initialized");const t=R.findIndex(t=>t.id===e);if(-1===t){console.error("‚ùå [MultiStep] Step not found:",{searchedFor:e,availableSteps:R.map(e=>({id:e.id,isBranch:e.isBranch})),totalSteps:R.length});const t=document.querySelector(`[data-answer="${e}"]`);if(t&&(console.error("üîç [MultiStep] Step exists in DOM but not registered:",{stepId:e,element:{tagName:t.tagName,id:t.id,className:t.className,hasStepAttribute:t.hasAttribute("data-form"),dataForm:p(t,"data-form"),parentElement:t.parentElement?.tagName,isStepWrapper:t.classList.contains("step_wrapper")}}),t.classList.contains("step_wrapper")&&p(t,"data-answer"))){console.warn("üîß [MultiStep] Attempting to register missing step:",e);const i="true"===p(t,"data-branch"),n=t.closest('[data-form="step"]'),a={element:t,id:e,index:R.length,isBranch:i,parentStepElement:n};return R.push(a),console.log("‚úÖ [MultiStep] Successfully registered missing step:",a),void P(R.length-1)}return}console.log("‚úÖ [MultiStep] Found step, navigating:",{stepId:e,stepIndex:t,currentIndex:F,isBranch:R[t].isBranch}),P(t)}function P(e){if(console.log("üéØ [MultiStep] GO TO STEP:",{targetIndex:e,currentIndex:F,totalSteps:R.length}),!C||e<0||e>=R.length)return void console.error("‚ùå [MultiStep] Invalid navigation:",{initialized:C,stepIndex:e,totalSteps:R.length});const t=R[e];if(-1!==F&&F!==e){const e=R[F];console.log("üëã [MultiStep] Hiding current step:",e.id),y(e.element),e.element.classList.remove("active-step")}console.log("üëÅÔ∏è [MultiStep] Showing target step:",t.id),function(e){f(e,"hidden-step");const t=e.getAttribute("data-original-display")||"";if(t&&"none"!==t)e.style.setProperty("display",t,"important");else{const t=e.classList.contains("flex")||e.classList.contains("d-flex")||e.classList.contains("step_wrapper")||"flex"===getComputedStyle(e).display;e.style.setProperty("display",t?"flex":"block","important")}e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),console.log("üîÑ [Utils] Showing element:",{element:e,tagName:e.tagName,id:e.id,className:e.className,originalDisplay:t||"none stored",currentDisplay:e.style.display,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:h(e)})}(t.element),t.element.classList.add("active-step"),_.add(t.id),F=e,D=t.id,O[O.length-1]!==t.id&&O.push(t.id),function(){const e=document.querySelector(o.NEXT_BTN),t=document.querySelector(o.BACK_BTN),i=document.querySelector(o.SUBMIT_BTN);if(!e||!t||!i)return;const n=0===F,a=F===R.length-1;t.style.display=n?"none":"",a?(e.style.display="none",i.style.display=""):(e.style.display="",i.style.display="none")}(),d.emit("step:change",{currentStepIndex:e,currentStepId:t.id,navigatedSteps:Array.from(_),isBranchStep:t.isBranch}),console.log("‚úÖ [MultiStep] Navigation complete:",{stepId:t.id,isBranch:t.isBranch,isVisible:h(t.element),hasActiveClass:t.element.classList.contains("active-step"),totalNavigatedSteps:_.size}),h(t.element)||(console.error("‚ùå [MultiStep] Step still not visible after show!"),function(e,t){const i=getComputedStyle(e),n=[];let a=e;for(;a&&a!==document.body;)n.push(a),a=a.parentElement;console.log(`üîç [MultiStep] Diagnosing visibility issues for step ${t}:`,{targetElement:{tagName:e.tagName,id:e.id,className:e.className,computedDisplay:i.display,computedVisibility:i.visibility,computedOpacity:i.opacity,inlineDisplay:e.style.display,inlineVisibility:e.style.visibility,inlineOpacity:e.style.opacity,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:h(e)},parentChain:n.map(e=>({tagName:e.tagName,id:e.id,className:e.className,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,computedOpacity:getComputedStyle(e).opacity,hasHiddenClass:e.classList.contains("hidden-step")})),possibleConflicts:{hasDisplayNone:"none"===i.display,hasVisibilityHidden:"hidden"===i.visibility,hasZeroOpacity:"0"===i.opacity,hasHiddenClass:e.classList.contains("hidden-step"),parentWithDisplayNone:n.some(e=>"none"===getComputedStyle(e).display),parentWithVisibilityHidden:n.some(e=>"hidden"===getComputedStyle(e).visibility)}})}(t.element,t.id))}function x(e,t){const i=t;let n=null;if(n=i.querySelector('input[type="radio"][data-go-to]'),!n&&i.htmlFor){const e=document.getElementById(i.htmlFor);e&&"radio"===e.type&&p(e,"data-go-to")&&(n=e)}n&&(console.log("üè∑Ô∏è [MultiStep] Label click detected for radio navigation:",{labelClicked:!0,radioId:n.id,dataGoTo:p(n,"data-go-to"),radioHidden:"0"===n.style.opacity||"absolute"===n.style.position}),n.checked=!0,n.dispatchEvent(new Event("change",{bubbles:!0})),H(e,n))}function B(e,t){if(t instanceof HTMLInputElement&&"radio"===t.type)return;const i=p(t,"data-go-to");i&&(e.preventDefault(),console.log("üéØ [MultiStep] Direct navigation triggered:",{element:t.tagName,className:t.className,goToValue:i}),V(i))}function H(e,t){const i=t;if(console.log("üéØ [MultiStep] Radio button navigation:",{radioName:i.name,radioValue:i.value,isChecked:i.checked,dataGoTo:p(i,"data-go-to"),eventType:e.type}),!i.checked)return;const n=p(i,"data-go-to");n?(!function(e){const t=e.name;if(!t)return;const i=p(e,"fs-inputactive-class")||"is-active-inputactive";document.querySelectorAll(`input[type="radio"][name="${t}"]`).forEach(t=>{const n=t,a=n.closest("label");n!==e&&(n.classList.remove(i),a?.classList.remove(i))}),e.classList.add(i);const n=e.closest("label");n?.classList.add(i)}(i),setTimeout(()=>{console.log("üöÄ [MultiStep] Navigating to step via radio button:",n);const e=R[F];e&&e.isBranch&&console.log("üìù [MultiStep] Storing branch selection:",{branchStepId:e.id,selectedOption:n,radioValue:i.value}),V(n)},100)):console.warn("‚ö†Ô∏è [MultiStep] Radio button missing data-go-to attribute")}function k(e){e.preventDefault();const t=R[F];if(!t)return void console.error("‚ùå [MultiStep] No current step found for next navigation");const i=p(t.element,"data-go-to");if(i)console.log("üîÄ [MultiStep] Using data-go-to for next navigation:",i),V(i);else{const e=F+1;e<R.length?(console.log("‚û°Ô∏è [MultiStep] Using linear navigation to index:",e),P(e)):console.log("üèÅ [MultiStep] Reached end of form")}}function U(e){if(e.preventDefault(),O.length>1){O.pop();const e=O[O.length-1];console.log("üîô [MultiStep] Back navigation using history:",{previousStepId:e,historyLength:O.length,fullHistory:[...O]}),V(e)}else{const e=F-1;e>=0?(console.log("üîô [MultiStep] Back navigation using linear index:",e),P(e)):console.log("üö´ [MultiStep] Already at first step")}}function q(e){u("Form submission - allowing default behavior")}function G(e,t){e.preventDefault();const i=p(t,"data-skip");i&&"true"!==i&&""!==i&&V(i)}var W=!1,j=[],Z=0;function Y(e=document){console.log("üöÄ [CLEAN] Ultra-minimal initialization starting...");const t=m(o.STEP,e);0!==t.length?(j=Array.from(t).map((e,t)=>{const i=e.querySelector(".step_wrapper[data-answer]");return{element:e,id:p(i||e,"data-answer")||`step-${t}`,index:t}}),console.log("‚úÖ [CLEAN] Steps registered:",j.map(e=>e.id)),K(),J(0),function(e){E(e,"change",'input[type="radio"][data-go-to]',(e,t)=>{const i=t;if(!i.checked)return;const n=p(i,"data-go-to");n?(console.log(`üîò [CLEAN] Radio clicked: ${i.name} ‚Üí ${n}`),function(e){const t=e.name;if(!t)return;const i="is-active-inputactive";document.querySelectorAll(`input[type="radio"][name="${t}"]`).forEach(e=>{const t=e,n=t.closest("label");t.classList.remove(i),n?.classList.remove(i)}),e.classList.add(i);const n=e.closest("label");n?.classList.add(i),console.log(`üé® [CLEAN] Styled radio: ${e.name}`)}(i),X(n)):console.warn("‚ö†Ô∏è [CLEAN] Radio missing data-go-to")});console.log("‚úÖ [CLEAN] Radio listeners setup")}(e),W=!0,console.log("‚úÖ [CLEAN] Initialization complete")):console.error("‚ùå [CLEAN] No steps found")}function K(){j.forEach(e=>{e.element.style.display="none",e.element.style.visibility="hidden",console.log(`üôà [CLEAN] Hiding: ${e.id}`)})}function J(e){if(e<0||e>=j.length)return void console.error("‚ùå [CLEAN] Invalid step index:",e);const t=j[e];K(),t.element.style.setProperty("display","block","important"),t.element.style.setProperty("visibility","visible","important"),t.element.style.setProperty("opacity","1","important"),Z=e,console.log(`‚úÖ [CLEAN] Showing: ${t.id} at index ${e}`)}function X(e){console.log(`üéØ [CLEAN] Navigate to: ${e}`);const t=j.findIndex(t=>t.id===e);if(-1===t)return console.error("‚ùå [CLEAN] Step not found:",e),void console.log("Available steps:",j.map(e=>e.id));J(t)}function Q(){return{initialized:W,currentStepIndex:Z,currentStepId:j[Z]?.id||"none",totalSteps:j.length,stepIds:j.map(e=>e.id)}}var ee=!1,te=[],ie=0;function ne(e,t){const i=(new Date).toISOString();console.log(`üîç [DIAGNOSTIC ${i}] ${e}`,t||"")}function ae(e,t){const i=(new Date).toISOString();console.error(`‚ùå [DIAGNOSTIC ${i}] ${e}`,t||"")}function oe(e,t){const i=getComputedStyle(e);ne(`DOM ${t}:`,{element:e.tagName,id:e.id,className:e.className,inlineStyles:{display:e.style.display,visibility:e.style.visibility,opacity:e.style.opacity},computedStyles:{display:i.display,visibility:i.visibility,opacity:i.opacity,position:i.position,zIndex:i.zIndex},dimensions:{offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight,clientWidth:e.clientWidth,clientHeight:e.clientHeight},parentInfo:{tagName:e.parentElement?.tagName,id:e.parentElement?.id,className:e.parentElement?.className}})}function se(e=document){ne("=== DIAGNOSTIC INITIALIZATION START ==="),ne("Root element:",{isDocument:e===document,elementType:e.constructor.name,hasQuerySelector:"function"==typeof e.querySelector}),ne("Checking for existing form libraries:",{window_FormLib:typeof window.FormLib,window_formLibrary:typeof window.formLibrary,existing_scripts:Array.from(document.scripts).map(e=>e.src).filter(e=>e.includes("form"))}),ne("Searching for steps with selector:",o.STEP);const t=m(o.STEP,e);ne("Step search results:",{selector:o.STEP,foundCount:t.length,allElementsWithDataForm:Array.from(document.querySelectorAll("[data-form]")).map(e=>({tagName:e.tagName,id:e.id,className:e.className,dataForm:e.getAttribute("data-form")}))}),0!==t.length?(te=Array.from(t).map((e,t)=>{ne(`Analyzing step ${t}:`),oe(e,`STEP_${t}_INITIAL`);const i=e.querySelector(".step_wrapper[data-answer]"),n=p(i||e,"data-answer");return ne(`Step ${t} data-answer analysis:`,{hasStepWrapper:!!i,stepWrapperDataAnswer:i?p(i,"data-answer"):null,directDataAnswer:p(e,"data-answer"),finalDataAnswer:n||`step-${t}`,allAttributes:Array.from(e.attributes).map(e=>({name:e.name,value:e.value}))}),{element:e,id:n||`step-${t}`,index:t}}),ne("All steps registered:",{totalSteps:te.length,stepMapping:te.map((e,t)=>({index:t,id:e.id,element:{tagName:e.element.tagName,id:e.element.id,className:e.element.className}}))}),le(),ne("=== INITIAL STEP HIDING ==="),re(),ne("=== SHOWING FIRST STEP ==="),de(0),function(e){ne("=== SETTING UP RADIO LISTENERS ===");const t=document.querySelectorAll('input[type="radio"][data-go-to]');ne("Found radio buttons:",{count:t.length,buttons:Array.from(t).map((e,t)=>({index:t,name:e.name,value:e.value,dataGoTo:e.getAttribute("data-go-to"),id:e.id,className:e.className}))});E(e,"change",'input[type="radio"][data-go-to]',(e,t)=>{ne("=== RADIO BUTTON EVENT TRIGGERED ===");const i=t;if(ne("Radio button analysis:",{eventType:e.type,radioName:i.name,radioValue:i.value,isChecked:i.checked,dataGoTo:p(i,"data-go-to"),eventTarget:e.target,eventCurrentTarget:e.currentTarget,timestamp:(new Date).toISOString()}),!i.checked)return void ne("Radio not checked, ignoring event");const n=p(i,"data-go-to");n?(ne("Processing radio navigation:",{from:te[ie]?.id,to:n,radioGroup:i.name}),function(e){ne("=== APPLYING RADIO STYLING ===");const t=e.name;if(!t)return;const i="is-active-inputactive",n=document.querySelectorAll(`input[type="radio"][name="${t}"]`);ne("Radio group styling:",{groupName:t,groupSize:n.length,activeClass:i}),n.forEach((t,n)=>{const a=t,o=a.closest("label"),s=a.classList.contains(i);a.classList.remove(i),o?.classList.remove(i),a===e?(a.classList.add(i),o?.classList.add(i),ne(`Applied active class to radio ${n}`)):s&&ne(`Removed active class from radio ${n}`)})}(i),ne("About to navigate..."),ce(n),ne("=== RADIO BUTTON EVENT COMPLETE ===")):ae("Radio button missing data-go-to attribute")});ne("Radio listeners setup complete")}(e),ne("=== DIAGNOSTIC INITIALIZATION COMPLETE ===",{initialized:ee=!0,totalSteps:te.length,currentStepIndex:ie,currentStepId:te[ie]?.id})):ae("No steps found - detailed analysis:",{searchRoot:e===document?"document":"custom element",allDataFormElements:document.querySelectorAll("[data-form]").length,allStepWrappers:document.querySelectorAll(".step_wrapper").length,allMultiFormSteps:document.querySelectorAll(".multi-form_step").length,possibleStepElements:Array.from(document.querySelectorAll("div")).filter(e=>e.className.includes("step")||e.id.includes("step")).map(e=>({tagName:e.tagName,id:e.id,className:e.className}))})}function le(){ne("=== CHECKING FOR CONFLICTS ===");const e=document.querySelectorAll('input[type="radio"][data-go-to]');ne("Radio buttons found:",{count:e.length,details:Array.from(e).map((e,t)=>{const i=e;return{index:t,name:i.name,value:i.value,dataGoTo:e.getAttribute("data-go-to"),hasListeners:null!==i.onclick||null!==i.onchange}})});document.querySelectorAll('[data-form="step"]').forEach((e,t)=>{const i=getComputedStyle(e);"none"!==i.display&&"hidden"!==i.visibility||ne(`Step ${t} already hidden by CSS:`,{element:e,computedDisplay:i.display,computedVisibility:i.visibility,possibleCSSRules:"Check for conflicting CSS"})}),ne("Window object analysis:",{FormLib:typeof window.FormLib,formLibrary:typeof window.formLibrary,jQuery:typeof window.$,webflow:typeof window.Webflow,allFormLibKeys:Object.keys(window).filter(e=>e.toLowerCase().includes("form"))})}function re(){ne("Hiding all steps - BEFORE state:"),te.forEach((e,t)=>{oe(e.element,`BEFORE_HIDE_${t}`)}),te.forEach((e,t)=>{ne(`Hiding step ${t} (${e.id}):`);const i={display:e.element.style.display,visibility:e.element.style.visibility,computedDisplay:getComputedStyle(e.element).display,isVisible:e.element.offsetHeight>0};e.element.style.setProperty("display","none","important"),e.element.style.setProperty("visibility","hidden","important");const n={display:e.element.style.display,visibility:e.element.style.visibility,computedDisplay:getComputedStyle(e.element).display,isVisible:e.element.offsetHeight>0};ne(`Step ${t} hide result:`,{stepId:e.id,before:i,after:n,hideSuccessful:!1===n.isVisible}),oe(e.element,`AFTER_HIDE_${t}`)})}function de(e){if(e<0||e>=te.length)return void ae("Invalid step index:",{stepIndex:e,totalSteps:te.length});const t=te[e];ne(`=== SHOWING STEP ${e} (${t.id}) ===`),ne("Hiding all other steps first..."),re(),oe(t.element,`BEFORE_SHOW_${e}`),ne(`Applying show styles to step ${e}:`),t.element.style.setProperty("display","block","important"),t.element.style.setProperty("visibility","visible","important"),t.element.style.setProperty("opacity","1","important"),t.element.offsetHeight,oe(t.element,`AFTER_SHOW_${e}`);const i=t.element.offsetHeight>0&&t.element.offsetWidth>0;if(ne(`Step ${e} show result:`,{stepId:t.id,isVisible:i,offsetHeight:t.element.offsetHeight,offsetWidth:t.element.offsetWidth,computedDisplay:getComputedStyle(t.element).display,computedVisibility:getComputedStyle(t.element).visibility}),!i){ae(`STEP ${e} FAILED TO SHOW!`,{stepId:t.id,possibleCauses:["CSS override with higher specificity","Parent element hidden","JavaScript interference","Layout engine issue"]});let i=t.element.parentElement,n=0;for(;i&&n<5;)oe(i,`PARENT_${n}`),i=i.parentElement,n++}ie=e}function ce(e){ne(`=== NAVIGATION REQUEST: ${e} ===`);const t=te.findIndex(t=>t.id===e);-1!==t?(ne(`Found step ${e} at index ${t}, navigating...`),de(t)):ae("Step not found:",{searchedFor:e,availableSteps:te.map(e=>e.id),totalSteps:te.length,suggestion:"Check data-answer attributes match exactly"})}function ue(){return{initialized:ee,currentStepIndex:ie,currentStepId:te[ie]?.id||"none",totalSteps:te.length,stepIds:te.map(e=>e.id),allStepsVisible:te.map(e=>({id:e.id,isVisible:e.element.offsetHeight>0,computedDisplay:getComputedStyle(e.element).display,computedVisibility:getComputedStyle(e.element).visibility}))}}"undefined"!=typeof window&&(window.FormLibDiagnostic={showStep:de,hideAll:re,goToStep:ce,getState:ue,checkConflicts:le,logAllSteps:()=>te.forEach((e,t)=>oe(e.element,`MANUAL_CHECK_${t}`))});var me=new Map,pe=new Map;function ge(e=document){u("Initializing error handling");e.querySelectorAll("input, select, textarea").forEach(e=>{const t=e.name||p(e,"data-step-field-name");t&&me.set(t,{fieldName:t,element:e,customMessage:p(e,"data-error-message")||void 0})}),d.registerModule("errors"),u(`Error handling initialized for ${me.size} fields`)}function fe(e,t){const i=me.get(e);if(!i)return void u(`Cannot show error for unknown field: ${e}`);const n=t||i.customMessage||"This field has an error";u(`Showing error for field: ${e}`,{message:n}),g(i.element,l.ERROR_FIELD);const a=function(e){if(!e||!e.element)return u("Cannot create error element - no config or element provided"),null;if(!e.element.parentElement)return u(`Cannot create error element for field: ${e.fieldName} - no parent element`,{element:e.element,parentElement:e.element.parentElement,nodeName:e.element.nodeName,id:e.element.id}),null;let t=null;try{t=e.element.parentElement.querySelector(`${o.ERROR_DISPLAY}[data-field="${e.fieldName}"]`)}catch(t){return u(`Error finding existing error element for field: ${e.fieldName}`,t),null}if(!t)try{t=document.createElement("div"),t.setAttribute("data-form","error"),t.setAttribute("data-field",e.fieldName);const i=e.element.parentElement,n=e.element.nextSibling;n?i.insertBefore(t,n):i.appendChild(t),u(`Created error element for field: ${e.fieldName}`)}catch(t){return u(`Error creating error element for field: ${e.fieldName}`,t),null}return t}(i);a&&(a.textContent=n,g(a,l.ACTIVE_ERROR),i.errorElement=a),function(e){const t=e.getBoundingClientRect();t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||(e.scrollIntoView({behavior:"smooth",block:"center"}),u(`Scrolled to field with error: ${e.name||"unnamed"}`))}(i.element)}function ye(e){const t=me.get(e);t?(u(`Clearing error for field: ${e}`),f(t.element,l.ERROR_FIELD),t.errorElement&&(t.errorElement.textContent="",f(t.errorElement,l.ACTIVE_ERROR))):u(`Cannot clear error for unknown field: ${e}`)}function he(){u("Clearing all field errors"),me.forEach((e,t)=>{ye(t)})}function Se(e){u("Showing multiple errors",e),Object.entries(e).forEach(([e,t])=>{fe(e,t)})}function ve(e){const t=me.get(e);return!!t&&t.element.classList.contains(l.ERROR_FIELD)}function Ee(){const e=[];return me.forEach((t,i)=>{ve(i)&&e.push(i)}),e}function be(){const e={};return pe.forEach((t,i)=>{e[i]={message:t.message}}),e}var Ie=!1,Ae=[],Ne=new Map,Te=new Set;function we(e=document){Ie&&(u("Validation already initialized, cleaning up first"),u("Resetting validation"),Ae.forEach(e=>e()),Ae=[],u("Clearing all field validation"),Ne.forEach((e,t)=>{!function(e){const t=Ne.get(e);t&&(t.isValid=!0,t.errorMessage=void 0,Re(t.element,!0),u(`Cleared validation for field: ${e}`))}(t)}),Ne.clear(),Te.clear(),Ie=!1,u("Validation reset complete")),u("Initializing form validation");const t=m("input, select, textarea",e);u(`Found ${t.length} form inputs`),t.forEach(e=>{if(!S(e))return;const t=e,i=t.name||p(e,"data-step-field-name");if(!i)return void u("Skipping field validation setup - no field name",{element:e,name:t.name,dataStepFieldName:p(e,"data-step-field-name"),id:t.id,type:t.type});const n=function(e){const t=[];e.hasAttribute("required")&&t.push({type:"required",message:p(e,"data-error-message")||"This field is required"}),e instanceof HTMLInputElement&&"email"===e.type&&t.push({type:"email",message:"Please enter a valid email address"}),e instanceof HTMLInputElement&&"tel"===e.type&&t.push({type:"phone",message:"Please enter a valid phone number"});const i=p(e,"minlength");i&&t.push({type:"min",value:parseInt(i),message:`Minimum ${i} characters required`});const n=p(e,"maxlength");n&&t.push({type:"max",value:parseInt(n),message:`Maximum ${n} characters allowed`});const a=p(e,"pattern");return a&&t.push({type:"pattern",value:new RegExp(a),message:"Please enter a valid format"}),t}(e);0!==n.length?(Ne.set(i,{element:e,rules:n,isValid:!0}),u(`Validation rules set for field: ${i}`,{rules:n.map(e=>e.type),rulesCount:n.length})):u(`No validation rules found for field: ${i}`)}),function(){const e=d.on("field:input",e=>{!function(e,t){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>e(...n),t)}}(()=>Le(e),s.VALIDATION_DELAY)()}),t=d.on("field:blur",Le),i=d.on("field:change",Le),n=d.on("step:change",e=>{e.currentStepId&&(Te.add(e.currentStepId),u(`Validation: Step ${e.currentStepId} marked as navigated`,{totalNavigatedSteps:Te.size,navigatedStepsList:Array.from(Te)}))});Ae.push(e,t,i,n),u("Validation module subscribed to centralized field and step events")}(),Ie=!0,d.registerModule("validation"),u("Validation initialization complete")}function Le(e){const{fieldName:t,element:i}=e;if(!t)return void u("Skipping validation - no field name found",{element:i,eventType:e.eventType});const n=i.closest(".step_wrapper[data-answer]");if(n){const e=p(n,"data-answer");if(e&&!Te.has(e))return void u(`Skipping validation for field in non-navigated step: ${t}`,{stepId:e,navigatedSteps:Array.from(Te),fieldInNavigatedStep:!1});u(`Validating field in navigated step: ${t}`,{stepId:e,navigatedSteps:Array.from(Te),fieldInNavigatedStep:!0})}Ce(t)}function Ce(e){const t=Ne.get(e);if(!t)return u(`No validation rules found for field: ${e}`),!0;const i=t.element;if(!i)return u(`No element found for field: ${e}`),!0;const n=v(i);u(`Validating field: ${e}`,{value:n,elementExists:!!i});for(const a of t.rules){const{isValid:o,message:s}=Me(n,a);if(!o)return t.isValid=!1,t.errorMessage=s||"Invalid field",fe(e,t.errorMessage),Re(i,!1,t.errorMessage),!1}return t.isValid=!0,ye(e),Re(i,!0),!0}var $e={email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,phone:/^[\+]?[1-9][\d]{0,15}$/,phoneUS:/^(\+1\s?)?(\([0-9]{3}\)|[0-9]{3})[\s\-]?[0-9]{3}[\s\-]?[0-9]{4}$/,url:/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/,zipCode:/^\d{5}(-\d{4})?$/,zipCodeCA:/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,creditCard:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3[0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})$/,ssn:/^\d{3}-?\d{2}-?\d{4}$/,strongPassword:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/};function Me(e,t){switch(t.type){case"required":return{isValid:Array.isArray(e)?e.length>0:!!e&&""!==String(e).trim(),message:t.message};case"email":return{isValid:$e.email.test(String(e)),message:t.message||"Please enter a valid email address"};case"phone":const i=String(e).replace(/[\s\-\(\)]/g,"");return{isValid:$e.phone.test(i)||$e.phoneUS.test(String(e)),message:t.message||"Please enter a valid phone number"};case"min":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length>=t.value,message:t.message||`Minimum ${t.value} characters required`};case"max":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length<=t.value,message:t.message||`Maximum ${t.value} characters allowed`};case"pattern":return t.value instanceof RegExp?{isValid:t.value.test(String(e)),message:t.message||"Please enter a valid format"}:{isValid:!0};case"custom":if(!t.validator)return{isValid:!0};try{return{isValid:t.validator(e),message:t.message||"Invalid value"}}catch(e){return u("Error in custom validator",{error:e,rule:t}),{isValid:!1,message:"Validation error occurred"}}default:return{isValid:!0}}}function Re(e,t,i){const n=e.name||p(e,"data-step-field-name");n&&(t?ye(n):fe(n,i))}function Fe(e){const t=function(e,t=document){if(t===document){const i=`single:${e}`;if(c.has(i))return c.get(i);const n=t.querySelector(e);return c.set(i,n),n}return t.querySelector(e)}(`[data-answer="${e}"]`);if(!t)return u(`Step not found with data-answer="${e}"`),!0;if(!h(t))return u(`Skipping validation for hidden step: ${e}`),!0;u(`Validating step: ${e}`);const i=t.querySelectorAll("input, select, textarea");let n=!0;return i.forEach(e=>{if(!S(e))return;const t=e.name||p(e,"data-step-field-name");if(t){Ce(t)||(n=!1)}}),u(`Step validation result: ${e}`,{isValid:n}),n}function De(){u("Validating all visible fields");let e=!0;const t={};for(const[i,n]of Ne){const a=n.element.closest(o.STEP);let s=!0;if(a){p(a,"data-answer")&&!h(a)&&(s=!1)}if(s){const n=Ce(i);t[i]=n,n||(e=!1)}}return u("All visible fields validation complete",{allValid:e,results:t}),e}var Oe=!1,_e=[],ze=[];function Ve(e=document){Oe&&(u("Summary already initialized, cleaning up first"),u("Resetting summary functionality"),_e.forEach(e=>e()),_e=[],ze.forEach(e=>{Ue(e.element,"")}),ze=[],Oe=!1,u("Summary reset complete")),u("Initializing summary functionality");const t=m(o.SUMMARY_FIELD,e);u(`Found ${t.length} summary fields`),function(e){e.forEach(e=>{const t=p(e,"data-summary-field");if(!t)return;const i=t.split("|").map(e=>e.trim()),n=p(e,"data-join"),a=n&&n in s.JOIN_SEPARATOR?n:"space",o=p(e,"data-summary-type")||void 0,l=p(e,"data-summary-subtype")||void 0,r=p(e,"data-summary-number")||void 0,d={element:e,fieldNames:i,joinType:a,type:o,subtype:l,number:r};ze.push(d),u("Summary field configured",{fieldNames:i,joinType:a,type:o,subtype:l,number:r})})}(t),function(){const e=d.on("field:change",Pe),t=d.on("field:input",Pe);_e.push(e,t),u("Summary module subscribed to centralized field events")}(),He(),Oe=!0,d.registerModule("summary"),u("Summary initialization complete")}function Pe(e){const{fieldName:t,value:i,eventType:n}=e;u(`Summary received field ${n}: ${t}`,{value:i}),xe(t)}function xe(e){ze.forEach(t=>{t.fieldNames.includes(e)&&ke(t)})}function Be(){u("Updating all summaries"),He()}function He(){ze.forEach(e=>{ke(e)})}function ke(e){const t=[];e.fieldNames.forEach(e=>{const i=r.getField(e);null!=i&&""!==i&&(Array.isArray(i)?t.push(...i.filter(e=>""!==e)):t.push(String(i)))});const i=function(e,t){if(0===e.length)return"";const i=s.JOIN_SEPARATOR[t];return e.join(i)}(t,e.joinType);Ue(e.element,i),u("Summary field updated",{fieldNames:e.fieldNames,values:t,joinType:e.joinType,result:i})}function Ue(e,t){e.textContent=t,""===t?(e.classList.add("summary-empty"),e.classList.remove("summary-filled")):(e.classList.remove("summary-empty"),e.classList.add("summary-filled"))}function qe(e){e?(u("Clearing specific summary fields",e),r.clearFields(e),e.forEach(e=>{xe(e)})):(u("Clearing all summaries"),r.clear(),He())}function Ge(){const e={};return ze.forEach((t,i)=>{const n=t.type&&t.subtype&&t.number?`${t.type}-${t.subtype}-${t.number}`:`summary-${i}`;e[n]={hasContent:(t.element.textContent||"").trim().length>0}}),e}console.log("üöÄ [FormLib] === SCRIPT VERSION CHECK ==="),console.log("üì¶ [FormLib] Script Version: CACHE_BUST_2025_01_10_14_45_FRESH"),console.log("üîó [FormLib] Expected URL: @9705259 or newer"),console.log("‚è∞ [FormLib] Load Time:",(new Date).toISOString());var We,je=class e{constructor(){this.initialized=!1,this.rootElement=document,u("FormLibrary instance created")}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e=document){this.initialized&&(u("FormLibrary already initialized, reinitializing..."),this.destroy()),this.rootElement=e,u("Initializing FormLibrary",{root:e===document?"document":"custom element"});const t=e.querySelectorAll(o.MULTISTEP),i=e.querySelectorAll(o.LOGIC),n=e.querySelectorAll(o.STEP);if(u("Form detection results",{multistepForms:t.length,logicForms:i.length,stepElements:n.length}),0!==t.length||0!==n.length)try{!function(e=document){b&&(u("Field coordinator already initialized, cleaning up first"),L()),u("Initializing centralized field coordinator");const t=E(e,"input","input, select, textarea",A),i=E(e,"change","input, select, textarea",N),n=E(e,"blur","input, select, textarea",T);I.push(t,i,n),b=!0,u("Field coordinator initialization complete")}(e),ge(e),we(e),(t.length>0||n.length>0)&&z(e),Ve(e),this.initialized=!0,u("FormLibrary initialization complete"),this.logCurrentState()}catch(e){throw u("FormLibrary initialization failed",e),e}else u("No compatible forms found, library will not initialize")}destroy(){if(this.initialized){u("Destroying FormLibrary");try{L()}catch(e){u("Error during FormLibrary destruction",e)}r.clear(),c.clear(),this.initialized=!1,u("FormLibrary destruction complete")}else u("FormLibrary not initialized, nothing to destroy")}isInitialized(){return this.initialized}getState(){return{initialized:this.initialized,formState:r.getDebugInfo(),multiStep:{note:"Simplified linear navigation - debug info removed"},validation:{initialized:Ie,fieldValidations:Array.from(Ne.entries()).reduce((e,[t,i])=>(e[t]={isValid:i.isValid,errorMessage:i.errorMessage,rules:i.rules.map(e=>e.type)},e),{})},errors:be(),summary:Ge()}}logCurrentState(){u("Current FormLibrary State",this.getState())}validateForm(){if(!this.initialized)return u("Cannot validate form - library not initialized"),!1;u("Validating entire form");const e=De();return u("Form validation result",{isValid:e}),e}resetForm(){if(this.initialized){u("Resetting form to initial state"),he(),r.clear(),qe();try{P(0)}catch(e){u("Could not go to first step during reset",e)}u("Form reset complete")}else u("Cannot reset form - library not initialized")}getFormData(){return r.getAll()}setFormData(e){Object.entries(e).forEach(([e,t])=>{r.setField(e,t)}),Be(),u("Form data set",e)}debugStepSystem(){!function(){console.log("üîç [MultiStep] === STEP SYSTEM DEBUG ==="),console.log("üìä Registered Steps:",{totalSteps:R.length,currentStepIndex:F,currentStepId:D,navigatedStepsCount:_.size}),R.forEach((e,t)=>{const i=t===F,n=_.has(e.id),a=h(e.element);console.log(`${i?"üëÅÔ∏è":"üí§"} Step ${t} (${e.id}):`,{isBranch:e.isBranch,isNavigated:n,isCurrentStep:i,elementVisible:a,elementDisplay:getComputedStyle(e.element).display,elementVisibility:getComputedStyle(e.element).visibility,hasActiveClass:e.element.classList.contains("active-step"),hasHiddenClass:e.element.classList.contains("hidden-step"),elementClasses:e.element.className})}),console.log("üìú Navigation History:",O),console.log("üóÇÔ∏è Navigated Steps:",Array.from(_));const e=document.querySelectorAll(".step_wrapper[data-answer]");e.length!==R.length&&console.warn("‚ö†Ô∏è DOM vs Registered Steps Mismatch:",{domCount:e.length,registeredCount:R.length,missing:Array.from(e).map(e=>p(e,"data-answer")).filter(e=>!R.some(t=>t.id===e))}),console.log("üîç [MultiStep] === DEBUG COMPLETE ===")}()}getNavigatedSteps(){return Array.from(_)}}.getInstance(),Ze=je;if("undefined"!=typeof window){const e=()=>{const e=document.querySelectorAll(o.MULTISTEP),t=document.querySelectorAll(o.STEP);(e.length>0||t.length>0)&&(u("Auto-initializing FormLibrary via Webflow.push"),je.init())},t=window;t.Webflow?.push?t.Webflow.push(e):"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}return"undefined"!=typeof window&&(window.FormLib=je,u("FormLib attached to window for debugging")),We=a,((a,o,s,l)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let r of i(o))n.call(a,r)||r===s||e(a,r,{get:()=>o[r],enumerable:!(l=t(o,r))||l.enumerable});return a})(e({},"__esModule",{value:!0}),We)})();