"use strict";var FormLib=(()=>{var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,a={};((t,i)=>{for(var n in i)e(t,n,{get:i[n],enumerable:!0})})(a,{FormState:()=>v,clearAllErrors:()=>Z,clearError:()=>Q,clearSummary:()=>Ee,default:()=>Pe,getCurrentStepInfo:()=>G,getNextStep:()=>_,goToStep:()=>j,initBranching:()=>T,initErrors:()=>X,initMultiStep:()=>D,initSummary:()=>fe,initValidation:()=>ae,resetBranching:()=>w,showError:()=>J,showStep:()=>U,updateSummary:()=>ye,validateAllVisibleFields:()=>ce,validateField:()=>se,validateStep:()=>de});var r={MULTISTEP:'[data-form="multistep"]',LOGIC:"[data-logic]",STEP:'[data-form="step"]',ANSWER:"[data-answer]",NEXT_BTN:'[data-form="next-btn"]',BACK_BTN:'[data-form="back-btn"]',SUBMIT:'[data-form="submit"]',SKIP:"[data-skip]",ERROR_DISPLAY:'[data-form="error"]',GO_TO:"[data-go-to]",SHOW_IF:"[data-show-if]",SKIP_BTN:'[data-form="skip-btn"]',SUBMIT_BTN:'[data-form="submit-btn"]',STEP_TYPE:"[data-step-type]",STEP_SUBTYPE:"[data-step-subtype]",STEP_NUMBER:"[data-step-number]",STEP_FIELD_NAME:"[data-step-field-name]",SUMMARY_FIELD:"[data-summary-field]",SUMMARY_TYPE:"[data-summary-type]",SUMMARY_SUBTYPE:"[data-summary-subtype]",SUMMARY_NUMBER:"[data-summary-number]",JOIN:"[data-join]",REQUIRED:"[required]",ERROR_MESSAGE:"[data-error-message]",VALIDATE:"[data-validate]"},s={START_STEP:1,DEBUG:!0,LOG_PREFIX:"[FormLib]",VALIDATION_DELAY:300,ANIMATION_DURATION:300,JOIN_SEPARATOR:{space:" ",comma:", ",dash:" - ",pipe:" | ",newline:"\n"}},o={ACTIVE_STEP:"active-step",HIDDEN_STEP:"hidden-step",HIDDEN_STEP_ITEM:"hidden-step-item",ERROR_FIELD:"error-field",ACTIVE_ERROR:"active-error",DISABLED:"disabled"};function l(e,t){if(!s.DEBUG)return;const i=(new Date).toISOString().split("T")[1].split(".")[0],n=`${s.LOG_PREFIX} [${i}]`;void 0!==t?console.log(`${n} ${e}`,t):console.log(`${n} ${e}`)}function d(e,t=document){return t.querySelectorAll(e)}function c(e,t=document){return t.querySelector(e)}function u(e,t){return e.getAttribute(t)}function m(e,t){e.classList.add(t)}function p(e,t){e.classList.remove(t)}function f(e){p(e,"hidden-step"),e.style.display="",l("Showing element:",e)}function h(e){m(e,"hidden-step"),e.style.display="none",l("Hiding element:",e)}function g(e){return"none"!==e.style.display&&!function(e,t){return e.classList.contains(t)}(e,"hidden-step")}function y(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}function S(e){return e instanceof HTMLInputElement?"checkbox"===e.type||"radio"===e.type?e.checked?e.value:"":e.value:e instanceof HTMLSelectElement&&e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value}function b(e,t,i,n){const a=e=>{const t=e.target?.closest(i);t&&n(e,t)};return e.addEventListener(t,a),()=>{e.removeEventListener(t,a)}}var v=class e{constructor(){this.data={},this.steps={},this.branchPath={currentStep:"",previousSteps:[],skippedSteps:[],activeConditions:{}},l("FormState initialized")}static getInstance(){return e.instance||(e.instance=new e),e.instance}setField(e,t){const i=this.data[e];this.data[e]=t,l(`Field updated: ${e}`,{oldValue:i,newValue:t}),this.onFieldChange(e,t,i)}getField(e){return this.data[e]}getAll(){return{...this.data}}clear(){const e={...this.data};this.data={},this.steps={},this.branchPath={currentStep:"",previousSteps:[],skippedSteps:[],activeConditions:{}},l("FormState cleared",{oldData:e})}clearFields(e){const t={};e.forEach(e=>{void 0!==this.data[e]&&(t[e]=this.data[e],delete this.data[e])}),Object.keys(t).length>0&&l("Fields cleared due to branch change",t)}setStepInfo(e,t){this.steps[e]||(this.steps[e]={visible:!1,visited:!1}),Object.assign(this.steps[e],t),l(`Step info updated: ${e}`,this.steps[e])}getStepInfo(e){return this.steps[e]}getAllSteps(){return{...this.steps}}setStepVisibility(e,t){this.setStepInfo(e,{visible:t}),l(`Step visibility updated: ${e}`,{visible:t})}setCurrentStep(e){this.branchPath.currentStep&&this.branchPath.currentStep!==e&&this.branchPath.previousSteps.push(this.branchPath.currentStep),this.branchPath.currentStep=e,this.setStepInfo(e,{visited:!0}),l(`Current step changed to: ${e}`,this.branchPath)}getCurrentStep(){return this.branchPath.currentStep}getBranchPath(){return{...this.branchPath}}addSkippedStep(e){this.branchPath.skippedSteps.includes(e)||(this.branchPath.skippedSteps.push(e),l(`Step skipped: ${e}`,this.branchPath.skippedSteps))}setActiveCondition(e,t){this.branchPath.activeConditions[e]=t,l(`Active condition set: ${e}`,t)}getActiveCondition(e){return this.branchPath.activeConditions[e]}getFieldsByStep(){const e={};return Object.entries(this.data).forEach(([t,i])=>{e[t]=i}),e}onFieldChange(e,t,i){t!==i&&l(`Field change detected: ${e}`,{from:i,to:t})}goToPreviousStep(){const e=this.branchPath.previousSteps.pop();return e?(this.branchPath.currentStep=e,l(`Went back to previous step: ${e}`,this.branchPath),e):null}wasStepVisited(e){return this.steps[e]?.visited||!1}isStepVisible(e){return this.steps[e]?.visible||!1}getDebugInfo(){return{data:this.data,steps:this.steps,branchPath:this.branchPath,fieldCount:Object.keys(this.data).length,stepCount:Object.keys(this.steps).length}}}.getInstance(),E=!1,I=[];function T(e=document){E&&(l("Branching already initialized, cleaning up first"),w()),l("Initializing branching logic"),function(e){const t=b(e,"change",r.GO_TO,P),i=b(e,"input",r.GO_TO,P),n=b(e,"click",r.GO_TO,P),a=b(e,"click","label.radio_field, .w-radio, .radio_button-skip-step, .w-form-formradioinput, .w-radio-input",A);I.push(t,i,n,a)}(e),E=!0,l("Branching initialization complete")}function A(e,t){let i=null;if(i=t.querySelector('input[type="radio"][data-go-to]'),!i){const e=t.closest("label");e&&(i=e.querySelector('input[type="radio"][data-go-to]'))}if(!i){const e=t.closest(".radio_field, .w-radio, .radio_component");e&&(i=e.querySelector('input[type="radio"][data-go-to]'))}if(i&&u(i,"data-go-to")){e.preventDefault(),e.stopPropagation(),i.checked=!0,F(i);const t=new Event("change",{bubbles:!0});Object.defineProperty(t,"target",{value:i}),P(t,i)}}function P(e,t){if(!y(t))return;const i=u(t,"data-go-to"),n=S(t);l("Branch trigger activated",{element:t,goTo:i,value:n,type:t.type||t.tagName});const a=t.name||u(t,"data-step-field-name");if(a&&v.setField(a,n),t instanceof HTMLInputElement)if("radio"===t.type&&t.checked){if(!i)return void l("Radio button has no data-go-to attribute, skipping navigation");!function(e){if(!e.name)return;document.querySelectorAll(`input[type="radio"][name="${e.name}"]`).forEach(t=>{const i=t,n=u(i,"data-go-to");var a;i!==e&&n&&(L(n),a=n,v.setStepVisibility(a,!1),l(`Set step item visibility to false in FormState: ${a}`))})}(t),F(t),$(i,t.value),function(e){if(!e)return void l("No stepItemId provided to triggerStepItemVisibility");l(`Triggering visibility for step_item: ${e}`),function(e){v.setStepVisibility(e,!0),l(`Set step item visibility to true in FormState: ${e}`)}(e)}(i)}else"checkbox"===t.type?t.checked?$(i,t.value):L(i):"radio"!==t.type&&"checkbox"!==t.type&&(n?$(i,n):L(i));else n?$(i,n):L(i);const r=v.getBranchPath().activeConditions;Object.values(r).some(e=>null!=e&&""!==e)&&C()}function F(e){const t=u(e,"fs-inputactive-class")||"is-active-inputactive";if(e.name){document.querySelectorAll(`input[type="radio"][name="${e.name}"]`).forEach(i=>{const n=i,a=n.closest("label");n!==e&&(n.classList.remove(t),a?.classList.remove(t))})}e.classList.add(t);const i=e.closest("label");i?.classList.add(t)}function $(e,t){e&&v.setActiveCondition(e,t)}function L(e){e&&(l(`Deactivating branch: ${e}`),v.setActiveCondition(e,null),function(e){const t=[];document.querySelectorAll(`[data-go-to="${e}"]`).forEach(e=>{y(e)&&e.name&&t.push(e.name)}),t.length>0&&v.clearFields(t)}(e),C())}function _(e){const t=v.getBranchPath().activeConditions;return Object.keys(t).find(e=>t[e])||null}function C(){const e=d(r.STEP),t=v.getBranchPath().activeConditions;e.forEach(e=>{const i=u(e,"data-answer"),n=function(e,t){if(!e)return!0;const i=c(`[data-answer="${e}"]`);if(i){const e=u(i,"data-show-if");if(e){const i=function(e,t){return t.hasOwnProperty(e)}(e,t);return i}}return!1}(i,t);i&&v.setStepVisibility(i,n)})}function w(){l("Resetting branching logic"),I.forEach(e=>e()),I=[];const e=v.getBranchPath().activeConditions;Object.keys(e).forEach(e=>{v.setActiveCondition(e,null)});d(r.ANSWER).forEach(e=>{const t=e;t.style.display="none",t.classList.add("hidden-step")}),E=!1,l("Branching reset complete")}var N=!1,V=[],R=[],M=[],O=0;function D(e=document){N&&(l("MultiStep already initialized, cleaning up first"),V.forEach(e=>e()),V=[],R=[],M=[],O=0,N=!1,l("Multi-step module reset")),l("Initializing multi-step navigation with step/step_item architecture");const t=d(r.STEP,e);l(`Found ${t.length} parent steps`),R=Array.from(t).map((e,t)=>{const i=e,n=u(e,"data-answer")||`step-${t}`,a={element:i,id:n,index:t,type:u(e,"data-step-type")||void 0,subtype:u(e,"data-step-subtype")||void 0,number:u(e,"data-step-number")||void 0,isStepItem:!1};return v.setStepInfo(n,{type:a.type,subtype:a.subtype,number:a.number,visible:0===t,visited:!1}),a}),M=[],R.forEach((e,t)=>{e.element.querySelectorAll(".step_item, .step-item").forEach(e=>{const i=e,n=u(e,"data-answer");if(!n)return void l(`Step item ${t} in parent step ${t} missing required data-answer attribute`);const a={element:i,id:n,index:M.length,type:u(e,"data-step-type")||void 0,subtype:u(e,"data-step-subtype")||void 0,number:u(e,"data-step-number")||void 0,isStepItem:!0,parentStepIndex:t};v.setStepInfo(n,{type:a.type,subtype:a.subtype,number:a.number,visible:!1,visited:!1}),M.push(a)})}),R.forEach((e,t)=>{h(e.element)}),M.forEach((e,t)=>{h(e.element)}),function(e){const t=b(e,"click",r.NEXT_BTN,B),i=b(e,"click",r.BACK_BTN,k),n=b(e,"click",r.SKIP_BTN,x),a=b(e,"click",r.SUBMIT_BTN,z);V.push(t,i,n,a)}(e),R.length>0&&j(0),N=!0,l("Multi-step initialization complete",{parentStepCount:R.length,stepItemCount:M.length})}function B(e){e.preventDefault(),H()}function k(e){e.preventDefault(),function(){const e=v.goToPreviousStep();if(e){const i=(t=e,R.findIndex(e=>e.id===t));if(-1!==i)return void j(i)}var t;const i=O-1;i>=0?j(i):l("Already at first step")}()}function x(e){e.preventDefault();const t=Y()?.element;if(t){Array.from(t.querySelectorAll("input, select, textarea")).forEach(e=>{e instanceof HTMLInputElement&&("checkbox"===e.type||"radio"===e.type)?e.checked=!1:e.value="",e.name&&v.setField(e.name,null)})}H(!0)}function z(e){if(!e.target.closest("form"))return void l("Form not found, preventing submission");if(!function(){for(const e of R)if(v.isStepVisible(e.id)&&!q(e.element))return!1;return!0}())return e.preventDefault(),void l("Form validation failed, preventing submission");l("Form validation passed, allowing submission")}function q(e){const t=e.querySelectorAll("input[required], select[required], textarea[required]");for(const e of t){const t=e;if(g(t)){if(!t.value||""===t.value.trim())return l("Validation failed: empty required field",{element:t,name:t.name,id:t.id}),t.focus(),!1;if("email"===t.type&&t.value){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value))return l("Validation failed: invalid email format"),t.focus(),!1}}}return!0}function j(e){if(l(`Attempting to go to step index: ${e}`),e<0||e>=R.length)return void l(`Invalid step index: ${e}`);-1!==O&&O<R.length&&function(e){if(e<0||e>=R.length)return;const t=R[e];h(t.element),v.setStepVisibility(t.id,!1),M.forEach(t=>{t.parentStepIndex===e&&h(t.element)}),l(`Hiding step ${e} (${t.id})`)}(O),U(e),O=e;const t=R[e];v.setCurrentStep(t.id),function(){const e=document.querySelector(r.NEXT_BTN),t=document.querySelector(r.BACK_BTN),i=document.querySelector(r.SUBMIT_BTN);if(!e||!t||!i)return;const n=0===O,a=O===R.length-1;t.style.display=n?"none":"",a?(e.style.display="none",i.style.display=""):(e.style.display="",i.style.display="none")}()}function U(e){if(e<0||e>=R.length)return;const t=R[e];f(t.element),v.setStepVisibility(t.id,!0),M.forEach(t=>{t.parentStepIndex===e&&v.isStepVisible(t.id)&&f(t.element)}),l(`Showing step ${e} (${t.id})`)}function H(e=!1){if(!Y())return void l("No current step found");const t=O+1;t<R.length?j(t):l("Already at last step")}function Y(){return R[O]||null}function G(){return{step:Y(),index:O,totalSteps:R.length,isFirstStep:0===O,isLastStep:O===R.length-1}}var K=new Map,W=new Map;function X(e=document){l("Initializing error handling");e.querySelectorAll("input, select, textarea").forEach(e=>{const t=e.name||u(e,"data-step-field-name");t&&K.set(t,{fieldName:t,element:e,customMessage:u(e,"data-error-message")||void 0})}),l(`Error handling initialized for ${K.size} fields`)}function J(e,t){const i=K.get(e);if(!i)return void l(`Cannot show error for unknown field: ${e}`);const n=t||i.customMessage||"This field has an error";l(`Showing error for field: ${e}`,{message:n}),m(i.element,o.ERROR_FIELD);const a=function(e){if(!e||!e.element)return l("Cannot create error element - no config or element provided"),null;if(!e.element.parentElement)return l(`Cannot create error element for field: ${e.fieldName} - no parent element`,{element:e.element,parentElement:e.element.parentElement,nodeName:e.element.nodeName,id:e.element.id}),null;let t=null;try{t=e.element.parentElement.querySelector(`${r.ERROR_DISPLAY}[data-field="${e.fieldName}"]`)}catch(t){return l(`Error finding existing error element for field: ${e.fieldName}`,t),null}if(!t)try{t=document.createElement("div"),t.setAttribute("data-form","error"),t.setAttribute("data-field",e.fieldName);const i=e.element.parentElement,n=e.element.nextSibling;n?i.insertBefore(t,n):i.appendChild(t),l(`Created error element for field: ${e.fieldName}`)}catch(t){return l(`Error creating error element for field: ${e.fieldName}`,t),null}return t}(i);a&&(a.textContent=n,m(a,o.ACTIVE_ERROR),i.errorElement=a),function(e){const t=e.getBoundingClientRect();t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||(e.scrollIntoView({behavior:"smooth",block:"center"}),l(`Scrolled to field with error: ${e.name||"unnamed"}`))}(i.element)}function Q(e){const t=K.get(e);t?(l(`Clearing error for field: ${e}`),p(t.element,o.ERROR_FIELD),t.errorElement&&(t.errorElement.textContent="",p(t.errorElement,o.ACTIVE_ERROR))):l(`Cannot clear error for unknown field: ${e}`)}function Z(){l("Clearing all field errors"),K.forEach((e,t)=>{Q(t)})}function ee(){const e={};return W.forEach((t,i)=>{e[i]={message:t.message}}),e}var te=!1,ie=[],ne=new Map;function ae(e=document){te&&(l("Validation already initialized, cleaning up first"),l("Resetting validation"),ie.forEach(e=>e()),ie=[],l("Clearing all field validation"),ne.forEach((e,t)=>{!function(e){const t=ne.get(e);t&&(t.isValid=!0,t.errorMessage=void 0,le(t.element,!0),l(`Cleared validation for field: ${e}`))}(t)}),ne.clear(),te=!1,l("Validation reset complete")),l("Initializing form validation");const t=d("input, select, textarea",e);l(`Found ${t.length} form inputs`),t.forEach(e=>{if(!y(e))return;const t=e,i=t.name||u(e,"data-step-field-name");if(!i)return void l("Skipping field validation setup - no field name",{element:e,name:t.name,dataStepFieldName:u(e,"data-step-field-name"),id:t.id,type:t.type});const n=function(e){const t=[];e.hasAttribute("required")&&t.push({type:"required",message:u(e,"data-error-message")||"This field is required"}),e instanceof HTMLInputElement&&"email"===e.type&&t.push({type:"email",message:"Please enter a valid email address"}),e instanceof HTMLInputElement&&"tel"===e.type&&t.push({type:"phone",message:"Please enter a valid phone number"});const i=u(e,"minlength");i&&t.push({type:"min",value:parseInt(i),message:`Minimum ${i} characters required`});const n=u(e,"maxlength");n&&t.push({type:"max",value:parseInt(n),message:`Maximum ${n} characters allowed`});const a=u(e,"pattern");return a&&t.push({type:"pattern",value:new RegExp(a),message:"Please enter a valid format"}),t}(e);0!==n.length?(ne.set(i,{element:e,rules:n,isValid:!0}),l(`Validation rules set for field: ${i}`,{rules:n.map(e=>e.type),rulesCount:n.length})):l(`No validation rules found for field: ${i}`)}),function(e){const t=function(e,t){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>e(...n),t)}}((...e)=>{re(e[0],e[1])},s.VALIDATION_DELAY),i=b(e,"input","input, select, textarea",t),n=b(e,"blur","input, select, textarea",re),a=b(e,"change","input, select, textarea",re);ie.push(i,n,a)}(e),te=!0,l("Validation initialization complete")}function re(e,t){if(!y(t))return;const i=t,n=i.name||u(t,"data-step-field-name");if(!n)return void l("Skipping validation - no field name found",{element:t,name:i.name,dataStepFieldName:u(t,"data-step-field-name")});const a=t.closest(r.STEP);if(a){const e=u(a,"data-answer");if(e&&!v.isStepVisible(e))return void l(`Skipping validation for field in hidden step: ${n}`)}se(n)}function se(e){const t=ne.get(e);if(!t)return l(`No validation rules found for field: ${e}`),!0;const i=t.element;if(!i)return l(`No element found for field: ${e}`),!0;const n=S(i);l(`Validating field: ${e}`,{value:n,elementExists:!!i});for(const a of t.rules){const{isValid:r,message:s}=oe(n,a);if(!r)return t.isValid=!1,t.errorMessage=s||"Invalid field",J(e,t.errorMessage),le(i,!1,t.errorMessage),!1}return t.isValid=!0,Q(e),le(i,!0),!0}function oe(e,t){switch(t.type){case"required":return{isValid:Array.isArray(e)?e.length>0:!!e,message:t.message};case"email":return{isValid:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e)),message:t.message};case"phone":return{isValid:/^\d{10}$/.test(String(e)),message:t.message};case"min":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length>=t.value,message:t.message};case"max":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length<=t.value,message:t.message};case"pattern":return t.value instanceof RegExp?{isValid:t.value.test(String(e)),message:t.message}:{isValid:!0};case"custom":return t.validator?{isValid:t.validator(e),message:t.message}:{isValid:!0};default:return{isValid:!0}}}function le(e,t,i){const n=e.name||u(e,"data-step-field-name");n&&(t?Q(n):J(n,i))}function de(e){const t=c(`[data-answer="${e}"]`);if(!t)return l(`Step not found with data-answer="${e}"`),!0;if(!v.isStepVisible(e))return l(`Skipping validation for hidden step: ${e}`),!0;l(`Validating step: ${e}`);const i=t.querySelectorAll("input, select, textarea");let n=!0;return i.forEach(e=>{if(!y(e))return;const t=e.name||u(e,"data-step-field-name");if(t){se(t)||(n=!1)}}),l(`Step validation result: ${e}`,{isValid:n}),n}function ce(){l("Validating all visible fields");let e=!0;const t={};for(const[i,n]of ne){const a=n.element.closest(r.STEP);let s=!0;if(a){const e=u(a,"data-answer");e&&!v.isStepVisible(e)&&(s=!1)}if(s){const n=se(i);t[i]=n,n||(e=!1)}}return l("All visible fields validation complete",{allValid:e,results:t}),e}var ue=!1,me=[],pe=[];function fe(e=document){ue&&(l("Summary already initialized, cleaning up first"),l("Resetting summary functionality"),me.forEach(e=>e()),me=[],pe.forEach(e=>{ve(e.element,"")}),pe=[],ue=!1,l("Summary reset complete")),l("Initializing summary functionality");const t=d(r.SUMMARY_FIELD,e);l(`Found ${t.length} summary fields`),function(e){e.forEach(e=>{const t=u(e,"data-summary-field");if(!t)return;const i=t.split("|").map(e=>e.trim()),n=u(e,"data-join"),a=n&&n in s.JOIN_SEPARATOR?n:"space",r=u(e,"data-summary-type")||void 0,o=u(e,"data-summary-subtype")||void 0,d=u(e,"data-summary-number")||void 0,c={element:e,fieldNames:i,joinType:a,type:r,subtype:o,number:d};pe.push(c),l("Summary field configured",{fieldNames:i,joinType:a,type:r,subtype:o,number:d})})}(t),function(e){const t=b(e,"input",r.STEP_FIELD_NAME,he),i=b(e,"change",r.STEP_FIELD_NAME,he),n=b(e,"blur",r.STEP_FIELD_NAME,he);me.push(t,i,n)}(e),Se(),ue=!0,l("Summary initialization complete")}function he(e,t){if(!y(t))return;const i=u(t,"data-step-field-name");if(!i)return;const n=S(t);l(`Summary field changed: ${i}`,{value:n}),v.setField(i,n),ge(i)}function ge(e){pe.forEach(t=>{t.fieldNames.includes(e)&&be(t)})}function ye(){l("Updating all summaries"),Se()}function Se(){pe.forEach(e=>{be(e)})}function be(e){const t=[];e.fieldNames.forEach(e=>{const i=v.getField(e);null!=i&&""!==i&&(Array.isArray(i)?t.push(...i.filter(e=>""!==e)):t.push(String(i)))});const i=function(e,t){if(0===e.length)return"";const i=s.JOIN_SEPARATOR[t];return e.join(i)}(t,e.joinType);ve(e.element,i),l("Summary field updated",{fieldNames:e.fieldNames,values:t,joinType:e.joinType,result:i})}function ve(e,t){e.textContent=t,""===t?(e.classList.add("summary-empty"),e.classList.remove("summary-filled")):(e.classList.remove("summary-empty"),e.classList.add("summary-filled"))}function Ee(e){e?(l("Clearing specific summary fields",e),v.clearFields(e),e.forEach(e=>{ge(e)})):(l("Clearing all summaries"),v.clear(),Se())}function Ie(){const e={};return pe.forEach((t,i)=>{const n=t.type&&t.subtype&&t.number?`${t.type}-${t.subtype}-${t.number}`:`summary-${i}`;e[n]={hasContent:(t.element.textContent||"").trim().length>0}}),e}var Te,Ae=class e{constructor(){this.initialized=!1,this.rootElement=document,l("FormLibrary instance created")}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e=document){this.initialized&&(l("FormLibrary already initialized, reinitializing..."),this.destroy()),this.rootElement=e,l("Initializing FormLibrary",{root:e===document?"document":"custom element"});const t=e.querySelectorAll(r.MULTISTEP),i=e.querySelectorAll(r.LOGIC),n=e.querySelectorAll(r.STEP);if(l("Form detection results",{multistepForms:t.length,logicForms:i.length,stepElements:n.length}),0!==t.length||0!==n.length)try{X(e),ae(e),i.length>0&&T(e),(t.length>0||n.length>0)&&D(e),fe(e),this.initialized=!0,l("FormLibrary initialization complete"),this.logCurrentState()}catch(e){throw l("FormLibrary initialization failed",e),e}else l("No compatible forms found, library will not initialize")}destroy(){if(this.initialized){l("Destroying FormLibrary");try{w()}catch(e){l("Error during FormLibrary destruction",e)}v.clear(),this.initialized=!1,l("FormLibrary destruction complete")}else l("FormLibrary not initialized, nothing to destroy")}isInitialized(){return this.initialized}getState(){return{initialized:this.initialized,formState:v.getDebugInfo(),branching:{initialized:E,activeConditions:v.getBranchPath().activeConditions,branchPath:v.getBranchPath()},multiStep:{initialized:N,currentStepIndex:O,totalSteps:R.length,steps:R.map(e=>({id:e.id,index:e.index,visible:g(e.element),type:e.type,subtype:e.subtype,number:e.number}))},validation:{initialized:te,fieldValidations:Array.from(ne.entries()).reduce((e,[t,i])=>(e[t]={isValid:i.isValid,errorMessage:i.errorMessage,rules:i.rules.map(e=>e.type)},e),{})},errors:ee(),summary:Ie()}}logCurrentState(){l("Current FormLibrary State",this.getState())}validateForm(){if(!this.initialized)return l("Cannot validate form - library not initialized"),!1;l("Validating entire form");const e=ce();return l("Form validation result",{isValid:e}),e}resetForm(){if(this.initialized){l("Resetting form to initial state"),Z(),v.clear(),Ee();try{j(0)}catch(e){l("Could not go to first step during reset",e)}l("Form reset complete")}else l("Cannot reset form - library not initialized")}getFormData(){return v.getAll()}setFormData(e){Object.entries(e).forEach(([e,t])=>{v.setField(e,t)}),ye(),l("Form data set",e)}}.getInstance(),Pe=Ae;if("undefined"!=typeof window){const e=()=>{const e=document.querySelectorAll(r.MULTISTEP),t=document.querySelectorAll(r.STEP);(e.length>0||t.length>0)&&(l("Auto-initializing FormLibrary on DOM ready"),Ae.init())};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}return"undefined"!=typeof window&&(window.FormLib=Ae,l("FormLib attached to window for debugging")),Te=a,((a,r,s,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let l of i(r))n.call(a,l)||l===s||e(a,l,{get:()=>r[l],enumerable:!(o=t(r,l))||o.enumerable});return a})(e({},"__esModule",{value:!0}),Te)})();