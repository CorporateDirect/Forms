"use strict";var FormLib=(()=>{var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,a={};((t,i)=>{for(var n in i)e(t,n,{get:i[n],enumerable:!0})})(a,{FormState:()=>d,clearAllErrors:()=>z,clearError:()=>x,clearSummary:()=>Ve,default:()=>Be,getCleanState:()=>me,getFieldsWithErrors:()=>D,goToStep:()=>K,goToStepById:()=>Y,goToStepByIdClean:()=>ue,hasError:()=>O,initBrowserValidationFix:()=>Me,initErrors:()=>R,initMultiStep:()=>W,initMultiStepClean:()=>le,initSummary:()=>Ce,initValidation:()=>ye,showError:()=>_,showErrors:()=>V,updateSummary:()=>Re,validateAllVisibleFields:()=>Ie,validateField:()=>ve,validateStep:()=>Ne});var o={MULTISTEP:'[data-form="multistep"]',LOGIC:"[data-logic]",STEP:'[data-form="step"]',ANSWER:"[data-answer]",GO_TO:"[data-go-to]",SKIP:"[data-skip]",NEXT_BTN:'[data-form="next-btn"]',BACK_BTN:'[data-form="back-btn"]',SUBMIT:'[data-form="submit"]',SUBMIT_BTN:'[data-form="submit-btn"]',ERROR_DISPLAY:'[data-form="error"]',SHOW_IF:"[data-show-if]",STEP_TYPE:"[data-step-type]",STEP_SUBTYPE:"[data-step-subtype]",STEP_NUMBER:"[data-step-number]",STEP_FIELD_NAME:"[data-step-field-name]",SUMMARY_FIELD:"[data-summary-field]",SUMMARY_TYPE:"[data-summary-type]",SUMMARY_SUBTYPE:"[data-summary-subtype]",SUMMARY_NUMBER:"[data-summary-number]",JOIN:"[data-join]",REQUIRED:"[required]",ERROR_MESSAGE:"[data-error-message]",VALIDATE:"[data-validate]",ALL_INPUTS:"input, select, textarea",FORM_FIELD_WRAPPER:".form-field_wrapper",FORM_FIELD_LABEL:".form_field-label",FORM_INPUT:".form_input",FORM_ERROR_MESSAGE:".form_error-message"},s={START_STEP:1,DEBUG:!0,LOG_PREFIX:"[FormLib]",VALIDATION_DELAY:300,ANIMATION_DURATION:300,JOIN_SEPARATOR:{space:" ",comma:", ",dash:" - ",pipe:" | ",newline:"\n"}},r={ACTIVE_STEP:"active-step",HIDDEN_STEP:"hidden-step",HIDDEN_STEP_ITEM:"hidden-step-item",ERROR_FIELD:"error-field",ACTIVE_ERROR:"active-error",DISABLED:"disabled",FORM_FIELD_WRAPPER:"form-field_wrapper",FORM_FIELD_LABEL:"form_field-label",FORM_INPUT:"form_input",FORM_ERROR_MESSAGE:"form_error-message"},l=class{constructor(){this.data={},m("FormState initialized (simplified)")}static getInstance(){return l.instance||(l.instance=new l),l.instance}setField(e,t){const i=this.data[e];this.data[e]=t,m(`Field updated: ${e}`,{oldValue:i,newValue:t})}getField(e){return this.data[e]}getAll(){return{...this.data}}clear(){const e={...this.data};this.data={},m("FormState cleared",{oldData:e})}clearFields(e){const t={};e.forEach(e=>{void 0!==this.data[e]&&(t[e]=this.data[e],delete this.data[e])}),Object.keys(t).length>0&&m("Fields cleared due to branch change",t)}getDebugInfo(){return{data:this.data,fieldCount:Object.keys(this.data).length}}},d=l.getInstance(),c=new class{constructor(){this.events={},this.moduleStates=new Map}registerModule(e){this.moduleStates.set(e,{initialized:!0,name:e})}unregisterModule(e){this.moduleStates.delete(e)}isModuleInitialized(e){return this.moduleStates.get(e)?.initialized??!1}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.off(e,t)}}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==t))}emit(e,t){const i=String(e);if(console.log(`ğŸ”„ [FormEvents] Emitting event: ${i}`,{eventData:t,timestamp:(new Date).toISOString(),hasListeners:!!this.events[e],listenerCount:this.events[e]?.length||0}),!this.events[e])return void console.warn(`âš ï¸ [FormEvents] No listeners registered for event: ${i}`);if("skip:request"===e&&!this.isModuleInitialized("multiStep"))return void console.error(`âŒ [FormEvents] CRITICAL: Skipping '${i}' event - multiStep module not initialized`,{eventData:t,registeredModules:Array.from(this.moduleStates.keys()),multiStepState:this.moduleStates.get("multiStep")});if("branch:change"===e&&!this.isModuleInitialized("multiStep"))return void console.error(`âŒ [FormEvents] CRITICAL: Skipping '${i}' event - multiStep module not initialized`,{eventData:t,registeredModules:Array.from(this.moduleStates.keys()),multiStepState:this.moduleStates.get("multiStep")});let n=0,a=0;this.events[e].forEach((o,s)=>{try{console.log(`ğŸ“¡ [FormEvents] Calling listener ${s+1}/${this.events[e].length} for ${i}`),o(t),n++,console.log(`âœ… [FormEvents] Listener ${s+1} completed successfully for ${i}`)}catch(n){a++,console.error(`ğŸ’¥ [FormEvents] LISTENER ERROR ${s+1}/${this.events[e].length} for '${i}':`,{error:n,errorMessage:n instanceof Error?n.message:String(n),errorStack:n instanceof Error?n.stack:void 0,eventData:t,listenerIndex:s})}}),console.log(`ğŸ“Š [FormEvents] Event ${i} completed:`,{totalListeners:this.events[e].length,successful:n,failed:a,eventData:t})}},u=new Map;function m(e,t){if(!s.DEBUG)return;const i=(new Date).toISOString().split("T")[1].split(".")[0],n=`${s.LOG_PREFIX} [${i}]`;void 0!==t?console.log(`${n} ${e}`,t):console.log(`${n} ${e}`)}function p(e,t=document){if(t===document){const i=`all:${e}`;if(u.has(i))return u.get(i);const n=t.querySelectorAll(e);return u.set(i,n),n}return t.querySelectorAll(e)}function f(e,t){return e.getAttribute(t)}function g(e,t){e.classList.add(t)}function h(e,t){e.classList.remove(t)}function y(e){h(e,"hidden-step");const t=e.getAttribute("data-original-display")||"",i=e.classList.contains("flex")||e.classList.contains("d-flex")||e.classList.contains("step_wrapper")||e.classList.contains("step-wrapper")||"flex"===getComputedStyle(e).display;let n="block";t&&"none"!==t?n=t:i&&(n="flex"),e.style.setProperty("display",n,"important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("transform","none","important"),e.style.removeProperty("height"),e.style.removeProperty("max-height"),e.style.removeProperty("width"),e.style.removeProperty("max-width"),console.log("ğŸ”„ [Utils] Showing element:",{element:e,tagName:e.tagName,id:e.id,className:e.className,dataAnswer:e.getAttribute("data-answer"),displayValue:n,originalDisplay:t||"none stored",currentDisplay:e.style.display,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,computedOpacity:getComputedStyle(e).opacity,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:v(e)})}function S(e){const t=getComputedStyle(e).display;t&&"none"!==t&&e.setAttribute("data-original-display",t),g(e,"hidden-step"),e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important"),e.style.setProperty("opacity","0","important"),console.log("ğŸ”„ [Utils] Hiding element:",{element:e,tagName:e.tagName,id:e.id,className:e.className,originalDisplay:t,currentDisplay:e.style.display,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:v(e)})}function v(e){const t=getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity&&!function(e,t){return e.classList.contains(t)}(e,"hidden-step")}function E(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}function b(e){return e instanceof HTMLInputElement?"checkbox"===e.type||"radio"===e.type?e.checked?e.value:"":e.value:e instanceof HTMLSelectElement&&e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value}function A(e,t,i,n){const a=e=>{const t=e.target?.closest(i);t&&n(e,t)};return e.addEventListener(t,a),()=>{e.removeEventListener(t,a)}}var N=!1,I=[];function M(e,t){if(!E(t))return;const i=w(t),n=b(t);i&&(d.setField(i,n),m("Field input detected",{fieldName:i,value:n,eventType:"input"}),c.emit("field:input",{fieldName:i,value:n,element:t,eventType:"input"}))}function L(e,t){if(!E(t))return;const i=w(t),n=b(t);i&&(d.setField(i,n),m("Field change detected",{fieldName:i,value:n,eventType:"change"}),c.emit("field:change",{fieldName:i,value:n,element:t,eventType:"change"}))}function T(e,t){if(!E(t))return;const i=w(t),n=b(t);i&&(m("Field blur detected",{fieldName:i,value:n,eventType:"blur"}),c.emit("field:blur",{fieldName:i,value:n,element:t,eventType:"blur"}))}function w(e){return e.name||f(e,"data-step-field-name")||null}function C(){N?(m("Resetting field coordinator"),I.forEach(e=>e()),I=[],N=!1,m("Field coordinator reset complete")):m("Field coordinator not initialized, nothing to reset")}var F=new Map,$=new Map;function R(e=document){m("Initializing error handling");e.querySelectorAll("input, select, textarea").forEach(e=>{const t=e.name||f(e,"data-step-field-name");t&&F.set(t,{fieldName:t,element:e,customMessage:f(e,"data-error-message")||void 0})}),c.registerModule("errors"),m(`Error handling initialized for ${F.size} fields`)}function _(e,t){const i=F.get(e);if(!i)return void m(`Cannot show error for unknown field: ${e}`);const n=i.customMessage||t||"This field has an error";m(`Showing error for field: ${e}`,{message:n,hasCustomMessage:!!i.customMessage,messageSource:i.customMessage?"html":t?"parameter":"fallback"}),g(i.element,r.ERROR_FIELD);const a=function(e){if(!e||!e.element)return m("Cannot create error element - no config or element provided"),null;if(!e.element.parentElement)return m(`Cannot create error element for field: ${e.fieldName} - no parent element`,{element:e.element,parentElement:e.element.parentElement,nodeName:e.element.nodeName,id:e.element.id}),null;let t=null;const i=e.element.closest(".form-field_wrapper");if(i){if(t=i.querySelector(".form_error-message"),t&&t.textContent&&""!==t.textContent.trim()){const i=t.textContent.trim();i.includes("This is some text inside of a div block")||(e.customMessage=i,m(`Found custom error message for field: ${e.fieldName}`,{customText:i}))}t||(t=i.querySelector('[data-form="error"]'))}if(!t){if(t=e.element.parentElement.querySelector(".form_error-message"),t&&t.textContent&&""!==t.textContent.trim()){const i=t.textContent.trim();i.includes("This is some text inside of a div block")||(e.customMessage=i,m(`Found custom error message for field: ${e.fieldName}`,{customText:i}))}}if(!t)try{t=e.element.parentElement.querySelector(`${o.ERROR_DISPLAY}[data-field="${e.fieldName}"]`)}catch(t){m(`Error finding existing error element for field: ${e.fieldName}`,t)}if(t)m(`Found existing error element for field: ${e.fieldName}`,{className:t.className,hasCustomMessage:!!e.customMessage});else try{t=document.createElement("div"),t.setAttribute("data-form","error"),t.setAttribute("data-field",e.fieldName),t.className="form_error-message",i?i.appendChild(t):e.element.parentElement.insertBefore(t,e.element.nextSibling),m(`Created new error element for field: ${e.fieldName}`)}catch(t){return m(`Failed to create error element for field: ${e.fieldName}`,t),null}return t}(i);a&&(i.customMessage&&!t||(a.textContent=n),g(a,r.ACTIVE_ERROR),i.errorElement=a,m(`Error element activated for field: ${e}`,{elementVisible:null!==a.offsetParent,hasActiveClass:a.classList.contains(r.ACTIVE_ERROR)})),function(e){const t=e.getBoundingClientRect();t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||(e.scrollIntoView({behavior:"smooth",block:"center"}),m(`Scrolled to field with error: ${e.name||"unnamed"}`))}(i.element)}function x(e){const t=F.get(e);t?(m(`Clearing error for field: ${e}`),h(t.element,r.ERROR_FIELD),t.errorElement&&(t.errorElement.textContent="",h(t.errorElement,r.ACTIVE_ERROR))):m(`Cannot clear error for unknown field: ${e}`)}function z(){m("Clearing all field errors"),F.forEach((e,t)=>{x(t)})}function V(e){m("Showing multiple errors",e),Object.entries(e).forEach(([e,t])=>{_(e,t)})}function O(e){const t=F.get(e);return!!t&&t.element.classList.contains(r.ERROR_FIELD)}function D(){const e=[];return F.forEach((t,i)=>{O(i)&&e.push(i)}),e}function P(){const e={};return $.forEach((t,i)=>{e[i]={message:t.message}}),e}var q=!1,B=[],k=[],U=[],H=-1,j="",Z=[],G=new Set;function W(e=document){q&&(m("MultiStep already initialized, cleaning up first"),function(){if(!q)return void m("Multi-step module not initialized, nothing to reset");m("Resetting multi-step module"),c.unregisterModule("multiStep"),B.forEach(e=>e()),B=[],U=[],H=-1,j="",Z=[],G.clear(),q=!1,k.forEach(e=>e()),k=[],m("Multi-step module reset")}()),console.log("ğŸš€ [MultiStep] === UPDATED STRUCTURE INITIALIZATION ===");const t=e.querySelectorAll(".step_wrapper[data-answer]");if(console.log("ğŸ“‹ [MultiStep] Found step wrappers with data-answer:",{count:t.length,selector:".step_wrapper[data-answer]"}),0!==t.length){if(U=Array.from(t).map((e,t)=>{const i=f(e,"data-answer"),n="true"===f(e,"data-branch"),a=e.closest('[data-form="step"]');return console.log(`âœ… [MultiStep] Registered step wrapper ${t}:`,{id:i,isBranch:n,hasParentStep:!!a,element:{tagName:e.tagName,className:e.className}}),{element:e,id:i||`step-${t}`,index:t,isBranch:n,parentStepElement:a}}),console.log("ğŸ“Š [MultiStep] Step registration complete:",{totalSteps:U.length,stepIds:U.map(e=>e.id),branchSteps:U.filter(e=>e.isBranch).map(e=>e.id),regularSteps:U.filter(e=>!e.isBranch).map(e=>e.id)}),U.forEach((e,t)=>{"step-0"===e.id?(console.log("ğŸ‘ï¸ [MultiStep] Keeping step-0 visible for progressive disclosure"),y(e.element),e.element.classList.add("active-step")):(console.log(`ğŸ«¥ [MultiStep] Hiding step ${t} (${e.id})`),S(e.element))}),function(e){const t=A(e,"click",o.NEXT_BTN,ee),i=A(e,"click",o.BACK_BTN,te),n=A(e,"click",o.SUBMIT_BTN,ie),a=A(e,"change",'input[type="radio"][data-go-to]',Q),s=A(e,"click",'input[type="radio"][data-go-to]',Q),r=A(e,"click","label",X),l=A(e,"click","[data-go-to]",J);B.push(t,i,n,a,s,r,l),m("Enhanced navigation listeners with Webflow compatibility setup complete")}(e),function(){const e=c.on("step:navigate",e=>{const t=e;console.log("ğŸ¯ [MultiStep] Navigation event received:",{targetStepId:t.targetStepId,reason:t.reason}),t.targetStepId&&Y(t.targetStepId)});k.push(e)}(),function(e){const t=A(e,"click",o.SKIP,ne);B.push(t),m("Skip listeners setup complete")}(e),U.length>0){const e=U.findIndex(e=>"step-0"===e.id);if(-1!==e){console.log("ğŸ¬ [MultiStep] Progressive disclosure: Setting step-0 as current"),H=e,j="step-0",Z=["step-0"],G.add("step-0");const t=U[e];y(t.element),t.element.classList.add("active-step"),ae(),c.emit("step:change",{currentStepIndex:e,currentStepId:"step-0",navigatedSteps:Array.from(G),isBranchStep:t.isBranch})}else console.log("ğŸ¬ [MultiStep] No step-0 found, showing first step"),K(0)}q=!0,c.registerModule("multiStep"),console.log("âœ… [MultiStep] Updated structure initialization complete")}else console.error("âŒ [MultiStep] No step wrappers with data-answer found!")}function Y(e){if(console.log("ğŸ¯ [MultiStep] NAVIGATION to step ID:",e),!q)return void console.error("âŒ [MultiStep] Not initialized");const t=U.findIndex(t=>t.id===e);if(-1===t){console.error("âŒ [MultiStep] Step not found:",{searchedFor:e,availableSteps:U.map(e=>({id:e.id,isBranch:e.isBranch})),totalSteps:U.length});const t=document.querySelector(`[data-answer="${e}"]`);if(t&&(console.error("ğŸ” [MultiStep] Step exists in DOM but not registered:",{stepId:e,element:{tagName:t.tagName,id:t.id,className:t.className,hasStepAttribute:t.hasAttribute("data-form"),dataForm:f(t,"data-form"),parentElement:t.parentElement?.tagName,isStepWrapper:t.classList.contains("step_wrapper")}}),t.classList.contains("step_wrapper")&&f(t,"data-answer"))){console.warn("ğŸ”§ [MultiStep] Attempting to register missing step:",e);const i="true"===f(t,"data-branch"),n=t.closest('[data-form="step"]'),a={element:t,id:e,index:U.length,isBranch:i,parentStepElement:n};return U.push(a),console.log("âœ… [MultiStep] Successfully registered missing step:",a),void K(U.length-1)}return}console.log("âœ… [MultiStep] Found step, navigating:",{stepId:e,stepIndex:t,currentIndex:H,isBranch:U[t].isBranch}),K(t)}function K(e){if(console.log("ğŸ¯ [MultiStep] GO TO STEP:",{targetIndex:e,currentIndex:H,totalSteps:U.length}),!q||e<0||e>=U.length)return void console.error("âŒ [MultiStep] Invalid navigation:",{initialized:q,stepIndex:e,totalSteps:U.length});const t=U[e];if(-1!==H&&H!==e){const e=U[H];console.log("ğŸ‘‹ [MultiStep] Hiding current step:",e.id),S(e.element),e.element.classList.remove("active-step")}console.log("ğŸ‘ï¸ [MultiStep] Showing target step:",t.id),y(t.element),t.element.classList.add("active-step"),G.add(t.id),H=e,j=t.id,Z[Z.length-1]!==t.id&&Z.push(t.id),ae(),c.emit("step:change",{currentStepIndex:e,currentStepId:t.id,navigatedSteps:Array.from(G),isBranchStep:t.isBranch}),console.log("âœ… [MultiStep] Navigation complete:",{stepId:t.id,isBranch:t.isBranch,isVisible:v(t.element),hasActiveClass:t.element.classList.contains("active-step"),totalNavigatedSteps:G.size}),v(t.element)||(console.error("âŒ [MultiStep] Step still not visible after show!"),function(e,t){const i=getComputedStyle(e),n=[];let a=e;for(;a&&a!==document.body;)n.push(a),a=a.parentElement;console.log(`ğŸ” [MultiStep] Diagnosing visibility issues for step ${t}:`,{targetElement:{tagName:e.tagName,id:e.id,className:e.className,computedDisplay:i.display,computedVisibility:i.visibility,computedOpacity:i.opacity,inlineDisplay:e.style.display,inlineVisibility:e.style.visibility,inlineOpacity:e.style.opacity,hasHiddenClass:e.classList.contains("hidden-step"),isVisible:v(e)},parentChain:n.map(e=>({tagName:e.tagName,id:e.id,className:e.className,computedDisplay:getComputedStyle(e).display,computedVisibility:getComputedStyle(e).visibility,computedOpacity:getComputedStyle(e).opacity,hasHiddenClass:e.classList.contains("hidden-step")})),possibleConflicts:{hasDisplayNone:"none"===i.display,hasVisibilityHidden:"hidden"===i.visibility,hasZeroOpacity:"0"===i.opacity,hasHiddenClass:e.classList.contains("hidden-step"),parentWithDisplayNone:n.some(e=>"none"===getComputedStyle(e).display),parentWithVisibilityHidden:n.some(e=>"hidden"===getComputedStyle(e).visibility)}})}(t.element,t.id))}function X(e,t){const i=t;let n=null;if(n=i.querySelector('input[type="radio"][data-go-to]'),!n&&i.htmlFor){const e=document.getElementById(i.htmlFor);e&&"radio"===e.type&&f(e,"data-go-to")&&(n=e)}n&&(console.log("ğŸ·ï¸ [MultiStep] Label click detected for radio navigation:",{labelClicked:!0,radioId:n.id,dataGoTo:f(n,"data-go-to"),radioHidden:"0"===n.style.opacity||"absolute"===n.style.position}),n.checked=!0,n.dispatchEvent(new Event("change",{bubbles:!0})),Q(e,n))}function J(e,t){if(t instanceof HTMLInputElement&&"radio"===t.type)return;if(t.classList.contains("step_wrapper")||t.classList.contains("step-wrapper")||f(t,"data-answer"))return void console.log("ğŸ›‘ [MultiStep] Ignoring navigation from step wrapper:",{stepId:f(t,"data-answer"),reason:"Step wrappers should not trigger direct navigation"});if(!("A"===t.tagName||"BUTTON"===t.tagName||f(t,"data-form")?.includes("btn")||f(t,"data-skip")||t.classList.contains("button")||t.closest('[data-form*="btn"]')||t.closest("button, a")))return void console.log("ğŸ›‘ [MultiStep] Ignoring navigation from non-navigation element:",{element:t.tagName,className:t.className,reason:"Only buttons, links, and navigation elements can trigger navigation"});const i=f(t,"data-go-to");i&&(e.preventDefault(),console.log("ğŸ¯ [MultiStep] Direct navigation triggered:",{element:t.tagName,className:t.className,goToValue:i,isNavigationElement:!0}),Y(i))}function Q(e,t){const i=t;if(console.log("ğŸ¯ [MultiStep] Radio button navigation:",{radioName:i.name,radioValue:i.value,isChecked:i.checked,dataGoTo:f(i,"data-go-to"),eventType:e.type}),!i.checked)return;const n=f(i,"data-go-to");n?(!function(e){const t=e.name;if(!t)return;const i=f(e,"fs-inputactive-class")||"is-active-inputactive";document.querySelectorAll(`input[type="radio"][name="${t}"]`).forEach(t=>{const n=t,a=n.closest("label");n!==e&&(n.classList.remove(i),a?.classList.remove(i))}),e.classList.add(i);const n=e.closest("label");n?.classList.add(i)}(i),setTimeout(()=>{console.log("ğŸš€ [MultiStep] Navigating to step via radio button:",n);const e=U[H];e&&e.isBranch&&console.log("ğŸ“ [MultiStep] Storing branch selection:",{branchStepId:e.id,selectedOption:n,radioValue:i.value}),Y(n)},100)):console.warn("âš ï¸ [MultiStep] Radio button missing data-go-to attribute")}function ee(e){e.preventDefault();const t=U[H];if(!t)return void console.error("âŒ [MultiStep] No current step found for next navigation");m("ğŸ” [MultiStep] Validating current step before navigation:",{stepId:t.id,stepIndex:H});const i=function(e){m("ğŸ” [MultiStep] Starting validation for step:",e.id);const t=e.element.querySelectorAll("input[data-required], select[data-required], textarea[data-required]");if(0===t.length)return m("âœ… [MultiStep] No required fields in step, validation passed"),!0;m(`ğŸ” [MultiStep] Found ${t.length} required fields to validate`);let i=!1;if(t.forEach((e,t)=>{const n=e,a=n.name||n.getAttribute("data-step-field-name")||`field-${t}`,o=n.value?.trim()||"";if(o)m(`âœ… [MultiStep] Required field is filled: ${a}`);else{i=!0;const e=function(e){const t=e.closest(".form-field_wrapper");if(t){const e=t.querySelector(".form_error-message");if(e&&e.textContent){const t=e.textContent.trim();if(!t.includes("This is some text inside of a div block"))return t}}const i=e.parentElement;if(i){const e=i.querySelector(".form_error-message");if(e&&e.textContent){const t=e.textContent.trim();if(!t.includes("This is some text inside of a div block"))return t}}return null}(n)||"This field is required";_(a,e),m(`âŒ [MultiStep] Required field is empty: ${a}`,{fieldType:n.type||n.tagName,value:o})}}),i){m(`ğŸš« [MultiStep] Validation failed - ${t.length} required fields with errors`);const i=e.element.querySelector("input[data-required], select[data-required], textarea[data-required]");return i&&(i.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>i.focus(),300)),!1}return m("âœ… [MultiStep] All required fields validated successfully"),!0}(t);if(!i)return void m("ğŸš« [MultiStep] Navigation blocked - validation failed for step:",t.id);m("âœ… [MultiStep] Validation passed, proceeding with navigation");const n=f(t.element,"data-go-to");if(n)console.log("ğŸ”€ [MultiStep] Using data-go-to for next navigation:",n),Y(n);else{const e=H+1;e<U.length?(console.log("â¡ï¸ [MultiStep] Using linear navigation to index:",e),K(e)):console.log("ğŸ [MultiStep] Reached end of form")}}function te(e){if(e.preventDefault(),Z.length>1){Z.pop();const e=Z[Z.length-1];console.log("ğŸ”™ [MultiStep] Back navigation using history:",{previousStepId:e,historyLength:Z.length,fullHistory:[...Z]}),Y(e)}else{const e=H-1;e>=0?(console.log("ğŸ”™ [MultiStep] Back navigation using linear index:",e),K(e)):console.log("ğŸš« [MultiStep] Already at first step")}}function ie(e){m("Form submission - allowing default behavior")}function ne(e,t){e.preventDefault();const i=f(t,"data-skip");i&&"true"!==i&&""!==i&&Y(i)}function ae(){const e=document.querySelector(o.NEXT_BTN),t=document.querySelector(o.BACK_BTN),i=document.querySelector(o.SUBMIT_BTN);if(!e||!t||!i)return;const n=0===H,a=H===U.length-1;t.style.display=n?"none":"",a?(e.style.display="none",i.style.display=""):(e.style.display="",i.style.display="none")}var oe=!1,se=[],re=0;function le(e=document){console.log("ğŸš€ [CLEAN] Ultra-minimal initialization starting...");const t=p(o.STEP,e);0!==t.length?(se=Array.from(t).map((e,t)=>{const i=e.querySelector(".step_wrapper[data-answer]");return{element:e,id:f(i||e,"data-answer")||`step-${t}`,index:t}}),console.log("âœ… [CLEAN] Steps registered:",se.map(e=>e.id)),de(),ce(0),function(e){A(e,"change",'input[type="radio"][data-go-to]',(e,t)=>{const i=t;if(!i.checked)return;const n=f(i,"data-go-to");n?(console.log(`ğŸ”˜ [CLEAN] Radio clicked: ${i.name} â†’ ${n}`),function(e){const t=e.name;if(!t)return;const i="is-active-inputactive";document.querySelectorAll(`input[type="radio"][name="${t}"]`).forEach(e=>{const t=e,n=t.closest("label");t.classList.remove(i),n?.classList.remove(i)}),e.classList.add(i);const n=e.closest("label");n?.classList.add(i),console.log(`ğŸ¨ [CLEAN] Styled radio: ${e.name}`)}(i),ue(n)):console.warn("âš ï¸ [CLEAN] Radio missing data-go-to")});console.log("âœ… [CLEAN] Radio listeners setup")}(e),oe=!0,console.log("âœ… [CLEAN] Initialization complete")):console.error("âŒ [CLEAN] No steps found")}function de(){se.forEach(e=>{e.element.style.display="none",e.element.style.visibility="hidden",console.log(`ğŸ™ˆ [CLEAN] Hiding: ${e.id}`)})}function ce(e){if(e<0||e>=se.length)return void console.error("âŒ [CLEAN] Invalid step index:",e);const t=se[e];de(),t.element.style.setProperty("display","block","important"),t.element.style.setProperty("visibility","visible","important"),t.element.style.setProperty("opacity","1","important"),re=e,console.log(`âœ… [CLEAN] Showing: ${t.id} at index ${e}`)}function ue(e){console.log(`ğŸ¯ [CLEAN] Navigate to: ${e}`);const t=se.findIndex(t=>t.id===e);if(-1===t)return console.error("âŒ [CLEAN] Step not found:",e),void console.log("Available steps:",se.map(e=>e.id));ce(t)}function me(){return{initialized:oe,currentStepIndex:re,currentStepId:se[re]?.id||"none",totalSteps:se.length,stepIds:se.map(e=>e.id)}}var pe=!1,fe=[],ge=new Map,he=new Set;function ye(e=document){pe&&(m("Validation already initialized, cleaning up first"),m("Resetting validation"),fe.forEach(e=>e()),fe=[],m("Clearing all field validation"),ge.forEach((e,t)=>{!function(e){const t=ge.get(e);t&&(t.isValid=!0,t.errorMessage=void 0,Ae(t.element,!0),m(`Cleared validation for field: ${e}`))}(t)}),ge.clear(),he.clear(),pe=!1,m("Validation reset complete")),m("Initializing form validation");const t=p("input, select, textarea",e);m(`Found ${t.length} form inputs`),t.forEach(e=>{if(!E(e))return;const t=e,i=t.name||f(e,"data-step-field-name");if(!i)return void m("Skipping field validation setup - no field name",{element:e,name:t.name,dataStepFieldName:f(e,"data-step-field-name"),id:t.id,type:t.type});const n=function(e){const t=[];(e.hasAttribute("required")||e.hasAttribute("data-required"))&&t.push({type:"required",message:f(e,"data-error-message")||"This field is required"}),e instanceof HTMLInputElement&&"email"===e.type&&t.push({type:"email",message:"Please enter a valid email address"}),e instanceof HTMLInputElement&&"tel"===e.type&&t.push({type:"phone",message:"Please enter a valid phone number"});const i=f(e,"minlength");i&&t.push({type:"min",value:parseInt(i),message:`Minimum ${i} characters required`});const n=f(e,"maxlength");n&&t.push({type:"max",value:parseInt(n),message:`Maximum ${n} characters allowed`});const a=f(e,"pattern");return a&&t.push({type:"pattern",value:new RegExp(a),message:"Please enter a valid format"}),t}(e);0!==n.length?(ge.set(i,{element:e,rules:n,isValid:!0}),m(`Validation rules set for field: ${i}`,{rules:n.map(e=>e.type),rulesCount:n.length})):m(`No validation rules found for field: ${i}`)}),function(){const e=c.on("field:input",e=>{!function(e,t){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>e(...n),t)}}(()=>Se(e),s.VALIDATION_DELAY)()}),t=c.on("field:blur",Se),i=c.on("field:change",Se),n=c.on("step:change",e=>{e.currentStepId&&(he.add(e.currentStepId),m(`Validation: Step ${e.currentStepId} marked as navigated`,{totalNavigatedSteps:he.size,navigatedStepsList:Array.from(he)}))});fe.push(e,t,i,n),m("Validation module subscribed to centralized field and step events")}(),pe=!0,c.registerModule("validation"),m("Validation initialization complete")}function Se(e){const{fieldName:t,element:i,eventType:n}=e;if(!t)return void m("Skipping validation - no field name found",{element:i,eventType:n});if(!("blur"===n||"change"===n))return void m(`Skipping validation for event type: ${n}`,{fieldName:t,eventType:n,reason:"Only validate on blur or change events"});const a=i.closest(".step_wrapper[data-answer]");if(a){const e=f(a,"data-answer");if(e&&!he.has(e))return void m(`Skipping validation for field in non-navigated step: ${t}`,{stepId:e,navigatedSteps:Array.from(he),fieldInNavigatedStep:!1,eventType:n});m(`Validating field in navigated step: ${t}`,{stepId:e,navigatedSteps:Array.from(he),fieldInNavigatedStep:!0,eventType:n})}ve(t)}function ve(e){const t=ge.get(e);if(!t)return m(`No validation rules found for field: ${e}`),!0;const i=t.element;if(!i)return m(`No element found for field: ${e}`),!0;const n=b(i);m(`Validating field: ${e}`,{value:n,elementExists:!!i});for(const a of t.rules){const{isValid:o,message:s}=be(n,a);if(!o)return t.isValid=!1,t.errorMessage=s||"Invalid field",_(e,t.errorMessage),Ae(i,!1,t.errorMessage),!1}return t.isValid=!0,x(e),Ae(i,!0),!0}var Ee={email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,phone:/^[\+]?[1-9][\d]{0,15}$/,phoneUS:/^(\+1\s?)?(\([0-9]{3}\)|[0-9]{3})[\s\-]?[0-9]{3}[\s\-]?[0-9]{4}$/,url:/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/,zipCode:/^\d{5}(-\d{4})?$/,zipCodeCA:/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,creditCard:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3[0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})$/,ssn:/^\d{3}-?\d{2}-?\d{4}$/,strongPassword:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/};function be(e,t){switch(t.type){case"required":return{isValid:Array.isArray(e)?e.length>0:!!e&&""!==String(e).trim(),message:t.message};case"email":return{isValid:Ee.email.test(String(e)),message:t.message||"Please enter a valid email address"};case"phone":const i=String(e).replace(/[\s\-\(\)]/g,"");return{isValid:Ee.phone.test(i)||Ee.phoneUS.test(String(e)),message:t.message||"Please enter a valid phone number"};case"min":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length>=t.value,message:t.message||`Minimum ${t.value} characters required`};case"max":return"number"!=typeof t.value?{isValid:!0}:{isValid:String(e).length<=t.value,message:t.message||`Maximum ${t.value} characters allowed`};case"pattern":return t.value instanceof RegExp?{isValid:t.value.test(String(e)),message:t.message||"Please enter a valid format"}:{isValid:!0};case"custom":if(!t.validator)return{isValid:!0};try{return{isValid:t.validator(e),message:t.message||"Invalid value"}}catch(e){return m("Error in custom validator",{error:e,rule:t}),{isValid:!1,message:"Validation error occurred"}}default:return{isValid:!0}}}function Ae(e,t,i){const n=e.name||f(e,"data-step-field-name");if(!n)return;t?(e.classList.remove("error-field"),x(n)):(e.classList.add("error-field"),_(n,i));const a=e.closest(".form-field_wrapper");a&&(t?a.classList.remove("error-field"):a.classList.add("error-field"))}function Ne(e){const t=function(e,t=document){if(t===document){const i=`single:${e}`;if(u.has(i))return u.get(i);const n=t.querySelector(e);return u.set(i,n),n}return t.querySelector(e)}(`[data-answer="${e}"]`);if(!t)return m(`Step not found with data-answer="${e}"`),!0;if(!v(t))return m(`Skipping validation for hidden step: ${e}`),!0;m(`Validating step: ${e}`);const i=t.querySelectorAll("input, select, textarea");let n=!0;return i.forEach(e=>{if(!E(e))return;const t=e.name||f(e,"data-step-field-name");if(t){ve(t)||(n=!1)}}),m(`Step validation result: ${e}`,{isValid:n}),n}function Ie(){m("Validating all visible fields");let e=!0;const t={};for(const[i,n]of ge){const a=n.element.closest(o.STEP);let s=!0;if(a){f(a,"data-answer")&&!v(a)&&(s=!1)}if(s){const n=ve(i);t[i]=n,n||(e=!1)}}return m("All visible fields validation complete",{allValid:e,results:t}),e}function Me(e=document){m("Initializing browser validation fix");const t=e.querySelectorAll("form");let i=0;t.forEach(e=>{e.hasAttribute("novalidate")||(e.setAttribute("novalidate","true"),i++,m(`Added novalidate to form: ${e.id||"unnamed"}`))});const n=e.querySelectorAll("input[required], select[required], textarea[required]");let a=0;n.forEach(e=>{const t=e.name||e.getAttribute("data-step-field-name")||"unnamed";e.setAttribute("data-required","true"),e.removeAttribute("required"),a++,m(`Fixed validation conflict: ${t} (required â†’ data-required)`)});return e.querySelectorAll("input, select, textarea").forEach(e=>{"setCustomValidity"in e&&"function"==typeof e.setCustomValidity&&e.setCustomValidity("")}),m(`Browser validation fix complete: ${i} forms, ${a} inputs fixed`),{formsFixed:i,inputsFixed:a,conflictsEliminated:a>0}}var Le=!1,Te=[],we=[];function Ce(e=document){Le&&(m("Summary already initialized, cleaning up first"),m("Resetting summary functionality"),Te.forEach(e=>e()),Te=[],we.forEach(e=>{ze(e.element,"")}),we=[],Le=!1,m("Summary reset complete")),m("Initializing summary functionality");const t=p(o.SUMMARY_FIELD,e);m(`Found ${t.length} summary fields`),function(e){e.forEach(e=>{const t=f(e,"data-summary-field");if(!t)return;const i=t.split("|").map(e=>e.trim()),n=f(e,"data-join"),a=n&&n in s.JOIN_SEPARATOR?n:"space",o=f(e,"data-summary-type")||void 0,r=f(e,"data-summary-subtype")||void 0,l=f(e,"data-summary-number")||void 0,d={element:e,fieldNames:i,joinType:a,type:o,subtype:r,number:l};we.push(d),m("Summary field configured",{fieldNames:i,joinType:a,type:o,subtype:r,number:l})})}(t),function(){const e=c.on("field:change",Fe),t=c.on("field:input",Fe);Te.push(e,t),m("Summary module subscribed to centralized field events")}(),_e(),Le=!0,c.registerModule("summary"),m("Summary initialization complete")}function Fe(e){const{fieldName:t,value:i,eventType:n}=e;m(`Summary received field ${n}: ${t}`,{value:i}),$e(t)}function $e(e){we.forEach(t=>{t.fieldNames.includes(e)&&xe(t)})}function Re(){m("Updating all summaries"),_e()}function _e(){we.forEach(e=>{xe(e)})}function xe(e){const t=[];e.fieldNames.forEach(e=>{const i=d.getField(e);null!=i&&""!==i&&(Array.isArray(i)?t.push(...i.filter(e=>""!==e)):t.push(String(i)))});const i=function(e,t){if(0===e.length)return"";const i=s.JOIN_SEPARATOR[t];return e.join(i)}(t,e.joinType);ze(e.element,i),m("Summary field updated",{fieldNames:e.fieldNames,values:t,joinType:e.joinType,result:i})}function ze(e,t){e.textContent=t,""===t?(e.classList.add("summary-empty"),e.classList.remove("summary-filled")):(e.classList.remove("summary-empty"),e.classList.add("summary-filled"))}function Ve(e){e?(m("Clearing specific summary fields",e),d.clearFields(e),e.forEach(e=>{$e(e)})):(m("Clearing all summaries"),d.clear(),_e())}function Oe(){const e={};return we.forEach((t,i)=>{const n=t.type&&t.subtype&&t.number?`${t.type}-${t.subtype}-${t.number}`:`summary-${i}`;e[n]={hasContent:(t.element.textContent||"").trim().length>0}}),e}console.log("ğŸš€ [FormLib] === SCRIPT VERSION CHECK ==="),console.log("ğŸ“¦ [FormLib] Script Version: CACHE_BUST_2025_01_28_21_00_NEXT_BUTTON_VALIDATION"),console.log("ğŸ”— [FormLib] Expected URL: @9705259 or newer"),console.log("â° [FormLib] Load Time:",(new Date).toISOString());var De,Pe=class{constructor(){this.initialized=!1,this.rootElement=document,m("FormLibrary instance created")}static getInstance(){return Pe.instance||(Pe.instance=new Pe),Pe.instance}init(e=document){this.initialized&&(m("FormLibrary already initialized, reinitializing..."),this.destroy()),this.rootElement=e,m("Initializing FormLibrary",{root:e===document?"document":"custom element"});const t=e.querySelectorAll(o.MULTISTEP),i=e.querySelectorAll(o.LOGIC),n=e.querySelectorAll(o.STEP);if(m("Form detection results",{multistepForms:t.length,logicForms:i.length,stepElements:n.length}),0!==t.length||0!==n.length)try{!function(e=document){N&&(m("Field coordinator already initialized, cleaning up first"),C()),m("Initializing centralized field coordinator");const t=A(e,"input","input, select, textarea",M),i=A(e,"change","input, select, textarea",L),n=A(e,"blur","input, select, textarea",T);I.push(t,i,n),N=!0,m("Field coordinator initialization complete")}(e),Me(e),R(e),ye(e),(t.length>0||n.length>0)&&W(e),Ce(e),this.initialized=!0,m("FormLibrary initialization complete"),this.logCurrentState()}catch(e){throw m("FormLibrary initialization failed",e),e}else m("No compatible forms found, library will not initialize")}destroy(){if(this.initialized){m("Destroying FormLibrary");try{C()}catch(e){m("Error during FormLibrary destruction",e)}d.clear(),u.clear(),this.initialized=!1,m("FormLibrary destruction complete")}else m("FormLibrary not initialized, nothing to destroy")}isInitialized(){return this.initialized}getState(){return{initialized:this.initialized,formState:d.getDebugInfo(),multiStep:{note:"Simplified linear navigation - debug info removed"},validation:{initialized:pe,fieldValidations:Array.from(ge.entries()).reduce((e,[t,i])=>(e[t]={isValid:i.isValid,errorMessage:i.errorMessage,rules:i.rules.map(e=>e.type)},e),{})},errors:P(),summary:Oe()}}logCurrentState(){m("Current FormLibrary State",this.getState())}validateForm(){if(!this.initialized)return m("Cannot validate form - library not initialized"),!1;m("Validating entire form");const e=Ie();return m("Form validation result",{isValid:e}),e}resetForm(){if(this.initialized){m("Resetting form to initial state"),z(),d.clear(),Ve();try{K(0)}catch(e){m("Could not go to first step during reset",e)}m("Form reset complete")}else m("Cannot reset form - library not initialized")}getFormData(){return d.getAll()}setFormData(e){Object.entries(e).forEach(([e,t])=>{d.setField(e,t)}),Re(),m("Form data set",e)}debugStepSystem(){!function(){console.log("ğŸ” [MultiStep] === STEP SYSTEM DEBUG ==="),console.log("ğŸ“Š Registered Steps:",{totalSteps:U.length,currentStepIndex:H,currentStepId:j,navigatedStepsCount:G.size}),U.forEach((e,t)=>{const i=t===H,n=G.has(e.id),a=v(e.element);console.log(`${i?"ğŸ‘ï¸":"ğŸ’¤"} Step ${t} (${e.id}):`,{isBranch:e.isBranch,isNavigated:n,isCurrentStep:i,elementVisible:a,elementDisplay:getComputedStyle(e.element).display,elementVisibility:getComputedStyle(e.element).visibility,hasActiveClass:e.element.classList.contains("active-step"),hasHiddenClass:e.element.classList.contains("hidden-step"),elementClasses:e.element.className})}),console.log("ğŸ“œ Navigation History:",Z),console.log("ğŸ—‚ï¸ Navigated Steps:",Array.from(G));const e=document.querySelectorAll(".step_wrapper[data-answer]");e.length!==U.length&&console.warn("âš ï¸ DOM vs Registered Steps Mismatch:",{domCount:e.length,registeredCount:U.length,missing:Array.from(e).map(e=>f(e,"data-answer")).filter(e=>!U.some(t=>t.id===e))}),console.log("ğŸ” [MultiStep] === DEBUG COMPLETE ===")}()}getNavigatedSteps(){return Array.from(G)}showError(e,t){_(e,t)}clearError(e){x(e)}clearAllErrors(){z()}hasError(e){return O(e)}getFieldsWithErrors(){return D()}},qe=Pe.getInstance(),Be=qe;if("undefined"!=typeof window){const e=()=>{const e=document.querySelectorAll(o.MULTISTEP),t=document.querySelectorAll(o.STEP);if(console.log("ğŸ” [FormLib] Auto-init check:",{multistepForms:e.length,stepElements:t.length,readyState:document.readyState}),e.length>0||t.length>0){console.log("ğŸš€ [FormLib] Auto-initializing FormLibrary");try{qe.init(),console.log("âœ… [FormLib] Auto-initialization complete")}catch(e){console.error("âŒ [FormLib] Auto-initialization failed:",e)}}else console.log("â­ï¸ [FormLib] No compatible forms found, skipping auto-init")},t=window;t.Webflow?.push?(console.log("ğŸŒ [FormLib] Using Webflow.push for initialization"),t.Webflow.push(e)):console.log("ğŸ”„ [FormLib] Webflow not available, using DOM events"),"loading"===document.readyState?(console.log("â³ [FormLib] DOM loading, waiting for ready"),document.addEventListener("DOMContentLoaded",e)):(console.log("âœ… [FormLib] DOM already ready, initializing now"),setTimeout(e,100)),setTimeout(()=>{qe.isInitialized()||(console.log("ğŸ” [FormLib] Fallback initialization attempt"),e())},1e3)}return"undefined"!=typeof window&&(window.FormLib=qe,m("FormLib attached to window for debugging")),De=a,((a,o,s,r)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let l of i(o))n.call(a,l)||l===s||e(a,l,{get:()=>o[l],enumerable:!(r=t(o,l))||r.enumerable});return a})(e({},"__esModule",{value:!0}),De)})();